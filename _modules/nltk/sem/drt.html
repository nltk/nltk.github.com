<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2D2D2D" />
  
  <title>NLTK :: nltk.sem.drt</title>
  

  <link rel="stylesheet" href="../../../_static/css/nltk_theme.css"/>
  <link rel="stylesheet" href="../../../_static/css/custom.css"/>

  <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
  

  <script src="https://email.tl.fortawesome.com/c/eJxNjUEOgyAQAF8jR7Kw6wIHDh7sP1Cw2mgxgmn6-3JsMqc5zEQfE8dkxOY1KKMUOI3ACFKRJpSW2AAp7ontYIaxI6i7XPJVwyeVfCQ550Os3jLrGSNOLgbdAy6s0PBk2TFNjEbsfq31LB0OnX407pJa5v2faRadwSW63mn5KuLyR9j2tgx3zecanl-55R_-jjPs"></script> 
</head>

<body>
  <div id="nltk-theme-container">
    <header>
      <div id="logo-container">
          
          <h1>
            <a href="../../../index.html">NLTK</a>
          </h1>
          
      </div>
      <div id="project-container">
        
        <h1>Documentation</h1>
        
      </div>

      <a id="menu-toggle" class="fa fa-bars" aria-hidden="true"></a>

      <script type="text/javascript">
        $("#menu-toggle").click(function() {
          $("#menu-toggle").toggleClass("toggled");
          $("#side-menu-container").slideToggle(300);
        });
      </script>
    </header>

    <div id="content-container">

      <div id="side-menu-container">

        <div id="search" role="search">
        <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
            <input type="text" name="q" placeholder="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
</div>

        <div id="side-menu" role="navigation">
          
  
    
  
  
    <p class="caption" role="heading"><span class="caption-text">NLTK Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/nltk.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto.html">Example Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../py-modindex.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/wiki">Wiki</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/wiki/FAQ">FAQ</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/issues">Open Issues</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk">NLTK on GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing NLTK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data.html">Installing NLTK Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../news.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute.html">Contributing to NLTK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../team.html">NLTK Team</a></li>
</ul>

  

        </div>

        
      </div>

      <div id="main-content-container">
        <div id="main-content" role="main">
          
  <h1>Source code for nltk.sem.drt</h1><div class="highlight"><pre>
<span></span><span class="c1"># Natural Language Toolkit: Discourse Representation Theory (DRT)</span>
<span class="c1">#</span>
<span class="c1"># Author: Dan Garrette &lt;dhgarrette@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2001-2023 NLTK Project</span>
<span class="c1"># URL: &lt;https://www.nltk.org/&gt;</span>
<span class="c1"># For license information, see LICENSE.TXT</span>

<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>

<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">APP</span><span class="p">,</span>
    <span class="n">AbstractVariableExpression</span><span class="p">,</span>
    <span class="n">AllExpression</span><span class="p">,</span>
    <span class="n">AndExpression</span><span class="p">,</span>
    <span class="n">ApplicationExpression</span><span class="p">,</span>
    <span class="n">BinaryExpression</span><span class="p">,</span>
    <span class="n">BooleanExpression</span><span class="p">,</span>
    <span class="n">ConstantExpression</span><span class="p">,</span>
    <span class="n">EqualityExpression</span><span class="p">,</span>
    <span class="n">EventVariableExpression</span><span class="p">,</span>
    <span class="n">ExistsExpression</span><span class="p">,</span>
    <span class="n">Expression</span><span class="p">,</span>
    <span class="n">FunctionVariableExpression</span><span class="p">,</span>
    <span class="n">ImpExpression</span><span class="p">,</span>
    <span class="n">IndividualVariableExpression</span><span class="p">,</span>
    <span class="n">LambdaExpression</span><span class="p">,</span>
    <span class="n">LogicParser</span><span class="p">,</span>
    <span class="n">NegatedExpression</span><span class="p">,</span>
    <span class="n">OrExpression</span><span class="p">,</span>
    <span class="n">Tokens</span><span class="p">,</span>
    <span class="n">Variable</span><span class="p">,</span>
    <span class="n">is_eventvar</span><span class="p">,</span>
    <span class="n">is_funcvar</span><span class="p">,</span>
    <span class="n">is_indvar</span><span class="p">,</span>
    <span class="n">unique_variable</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Import Tkinter-based modules if they are available</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">Canvas</span><span class="p">,</span> <span class="n">Tk</span>
    <span class="kn">from</span> <span class="nn">tkinter.font</span> <span class="kn">import</span> <span class="n">Font</span>

    <span class="kn">from</span> <span class="nn">nltk.util</span> <span class="kn">import</span> <span class="n">in_idle</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1"># No need to print a warning here, nltk.draw has already printed one.</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="DrtTokens"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtTokens">[docs]</a><span class="k">class</span> <span class="nc">DrtTokens</span><span class="p">(</span><span class="n">Tokens</span><span class="p">):</span>
    <span class="n">DRS</span> <span class="o">=</span> <span class="s2">&quot;DRS&quot;</span>
    <span class="n">DRS_CONC</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
    <span class="n">PRONOUN</span> <span class="o">=</span> <span class="s2">&quot;PRO&quot;</span>
    <span class="n">OPEN_BRACKET</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span>
    <span class="n">CLOSE_BRACKET</span> <span class="o">=</span> <span class="s2">&quot;]&quot;</span>
    <span class="n">COLON</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span>

    <span class="n">PUNCT</span> <span class="o">=</span> <span class="p">[</span><span class="n">DRS_CONC</span><span class="p">,</span> <span class="n">OPEN_BRACKET</span><span class="p">,</span> <span class="n">CLOSE_BRACKET</span><span class="p">,</span> <span class="n">COLON</span><span class="p">]</span>

    <span class="n">SYMBOLS</span> <span class="o">=</span> <span class="n">Tokens</span><span class="o">.</span><span class="n">SYMBOLS</span> <span class="o">+</span> <span class="n">PUNCT</span>

    <span class="n">TOKENS</span> <span class="o">=</span> <span class="n">Tokens</span><span class="o">.</span><span class="n">TOKENS</span> <span class="o">+</span> <span class="p">[</span><span class="n">DRS</span><span class="p">]</span> <span class="o">+</span> <span class="n">PUNCT</span></div>


<div class="viewcode-block" id="DrtParser"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser">[docs]</a><span class="k">class</span> <span class="nc">DrtParser</span><span class="p">(</span><span class="n">LogicParser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A lambda calculus expression parser.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="DrtParser.__init__"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">LogicParser</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">operator_precedence</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">LAMBDA_LIST</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">NOT_LIST</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="n">APP</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">EQ_LIST</span> <span class="o">+</span> <span class="n">Tokens</span><span class="o">.</span><span class="n">NEQ_LIST</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">COLON</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">DRS_CONC</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OR_LIST</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IMP_LIST</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.get_all_symbols"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.get_all_symbols">[docs]</a>    <span class="k">def</span> <span class="nf">get_all_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method exists to be overridden&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">SYMBOLS</span></div>

<div class="viewcode-block" id="DrtParser.isvariable"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.isvariable">[docs]</a>    <span class="k">def</span> <span class="nf">isvariable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tok</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">TOKENS</span></div>

<div class="viewcode-block" id="DrtParser.handle"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.handle">[docs]</a>    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is intended to be overridden for logics that</span>
<span class="sd">        use different operators or expressions&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">NOT_LIST</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_negation</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">LAMBDA_LIST</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_lambda</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">tok</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN_BRACKET</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_DRS</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_open</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">tok</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DRS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_DRS</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">isvariable</span><span class="p">(</span><span class="n">tok</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">COLON</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_prop</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_variable</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.make_NegatedExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.make_NegatedExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_NegatedExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtNegatedExpression</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.handle_DRS"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.handle_DRS">[docs]</a>    <span class="k">def</span> <span class="nf">handle_DRS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="c1"># a DRS</span>
        <span class="n">refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_refs</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">COMMA</span>
        <span class="p">):</span>  <span class="c1"># if there is a comma (it&#39;s optional)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>  <span class="c1"># swallow the comma</span>
        <span class="n">conds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_conds</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span><span class="n">refs</span><span class="p">,</span> <span class="n">conds</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.handle_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.handle_refs">[docs]</a>    <span class="k">def</span> <span class="nf">handle_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN_BRACKET</span><span class="p">)</span>
        <span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE_BRACKET</span><span class="p">:</span>
            <span class="c1"># Support expressions like: DRS([x y],C) == DRS([x,y],C)</span>
            <span class="k">if</span> <span class="n">refs</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">COMMA</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>  <span class="c1"># swallow the comma</span>
            <span class="n">refs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_token_variable</span><span class="p">(</span><span class="s2">&quot;quantified&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE_BRACKET</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">refs</span></div>

<div class="viewcode-block" id="DrtParser.handle_conds"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.handle_conds">[docs]</a>    <span class="k">def</span> <span class="nf">handle_conds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN_BRACKET</span><span class="p">)</span>
        <span class="n">conds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE_BRACKET</span><span class="p">:</span>
            <span class="c1"># Support expressions like: DRS([x y],C) == DRS([x, y],C)</span>
            <span class="k">if</span> <span class="n">conds</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">COMMA</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>  <span class="c1"># swallow the comma</span>
            <span class="n">conds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_next_expression</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE_BRACKET</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">conds</span></div>

<div class="viewcode-block" id="DrtParser.handle_prop"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.handle_prop">[docs]</a>    <span class="k">def</span> <span class="nf">handle_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_next_expression</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">COLON</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DrtProposition</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">drs</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.make_EqualityExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.make_EqualityExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_EqualityExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method serves as a hook for other logic parsers that</span>
<span class="sd">        have different equality expression classes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DrtEqualityExpression</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.get_BooleanExpression_factory"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.get_BooleanExpression_factory">[docs]</a>    <span class="k">def</span> <span class="nf">get_BooleanExpression_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method serves as a hook for other logic parsers that</span>
<span class="sd">        have different boolean operators&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tok</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DRS_CONC</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="n">DrtConcatenation</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OR_LIST</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DrtOrExpression</span>
        <span class="k">elif</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IMP_LIST</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">make_imp_expression</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">first</span><span class="o">.</span><span class="n">conds</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">DrtConcatenation</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">DrtConcatenation</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">first</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Antecedent of implication must be a DRS&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">make_imp_expression</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DrtParser.make_BooleanExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.make_BooleanExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_BooleanExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factory</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">factory</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.make_ApplicationExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.make_ApplicationExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_ApplicationExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtApplicationExpression</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtParser.make_VariableExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.make_VariableExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_VariableExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div>

<div class="viewcode-block" id="DrtParser.make_LambdaExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtParser.make_LambdaExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_LambdaExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">term</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtLambdaExpression</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DrtExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtExpression</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the base abstract DRT Expression from which every DRT</span>
<span class="sd">    Expression extends.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_drt_parser</span> <span class="o">=</span> <span class="n">DrtParser</span><span class="p">()</span>

<div class="viewcode-block" id="DrtExpression.fromstring"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.fromstring">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromstring</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_drt_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.applyto"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.applyto">[docs]</a>    <span class="k">def</span> <span class="nf">applyto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtApplicationExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtNegatedExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DrtExpression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DrtOrExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DrtExpression</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DrtConcatenation</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DrtConcatenation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Antecedent of implication must be a DRS&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="DrtExpression.equiv"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.equiv">[docs]</a>    <span class="k">def</span> <span class="nf">equiv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">prover</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check for logical equivalence.</span>
<span class="sd">        Pass the expression (self &lt;-&gt; other) to the theorem prover.</span>
<span class="sd">        If the prover says it is valid, then the self and other are equal.</span>

<span class="sd">        :param other: an ``DrtExpression`` to check equality against</span>
<span class="sd">        :param prover: a ``nltk.inference.api.Prover``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DrtExpression</span><span class="p">)</span>

        <span class="n">f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f1</span><span class="o">.</span><span class="n">equiv</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">prover</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; object has no attribute &#39;type&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DrtExpression.typecheck"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.typecheck">[docs]</a>    <span class="k">def</span> <span class="nf">typecheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signature</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtConcatenation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="DrtExpression.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the set of discourse referents in this DRS.</span>
<span class="sd">        :param recursive: bool Also find discourse referents in subterms?</span>
<span class="sd">        :return: list of ``Variable`` objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="DrtExpression.is_pronoun_function"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.is_pronoun_function">[docs]</a>    <span class="k">def</span> <span class="nf">is_pronoun_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Is self of the form &quot;PRO(x)&quot;?&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtAbstractVariableExpression</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">PRONOUN</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">DrtIndividualVariableExpression</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.make_EqualityExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.make_EqualityExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_EqualityExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtEqualityExpression</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.make_VariableExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.make_VariableExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_VariableExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.resolve_anaphora"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.resolve_anaphora">[docs]</a>    <span class="k">def</span> <span class="nf">resolve_anaphora</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">resolve_anaphora</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.eliminate_equality"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.eliminate_equality">[docs]</a>    <span class="k">def</span> <span class="nf">eliminate_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_structured</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">eliminate_equality</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.pretty_format"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.pretty_format">[docs]</a>    <span class="k">def</span> <span class="nf">pretty_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the DRS</span>
<span class="sd">        :return: the pretty print string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pretty</span><span class="p">())</span></div>

<div class="viewcode-block" id="DrtExpression.pretty_print"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.pretty_print">[docs]</a>    <span class="k">def</span> <span class="nf">pretty_print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pretty_format</span><span class="p">())</span></div>

<div class="viewcode-block" id="DrtExpression.draw"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtExpression.draw">[docs]</a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">DrsDrawer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="DRS"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS">[docs]</a><span class="k">class</span> <span class="nc">DRS</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Discourse Representation Structure.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="DRS.__init__"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refs</span><span class="p">,</span> <span class="n">conds</span><span class="p">,</span> <span class="n">consequent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param refs: list of ``DrtIndividualVariableExpression`` for the</span>
<span class="sd">            discourse referents</span>
<span class="sd">        :param conds: list of ``Expression`` for the conditions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refs</span> <span class="o">=</span> <span class="n">refs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conds</span> <span class="o">=</span> <span class="n">conds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span></div>

<div class="viewcode-block" id="DRS.replace"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.replace">[docs]</a>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace all instances of variable v with expression E in self,</span>
<span class="sd">        where v is free in self.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span>
            <span class="c1"># if a bound variable is the thing being replaced</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">replace_bound</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
                    <span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                        <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha_convert</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">consequent</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="o">.</span><span class="n">variable</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:],</span>
                    <span class="p">[</span>
                        <span class="n">cond</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span>
                    <span class="p">],</span>
                    <span class="n">consequent</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">alpha_convert</span><span class="p">:</span>
                <span class="c1"># any bound variable that appears in the expression must</span>
                <span class="c1"># be alpha converted to avoid a conflict</span>
                <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">expression</span><span class="o">.</span><span class="n">free</span><span class="p">():</span>
                    <span class="n">newvar</span> <span class="o">=</span> <span class="n">unique_variable</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
                    <span class="n">newvarex</span> <span class="o">=</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">newvar</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
                        <span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                            <span class="n">ref</span><span class="p">,</span> <span class="n">newvarex</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha_convert</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">consequent</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="bp">self</span> <span class="o">=</span> <span class="n">DRS</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">newvar</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:],</span>
                        <span class="p">[</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">newvarex</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span>
                        <span class="p">],</span>
                        <span class="n">consequent</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="c1"># replace in the conditions</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
                <span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">consequent</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="n">cond</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span>
                <span class="p">],</span>
                <span class="n">consequent</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="DRS.free"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: Expression.free()&quot;&quot;&quot;</span>
        <span class="n">conds_free</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">free</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">],</span> <span class="nb">set</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="n">conds_free</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">free</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">conds_free</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRS.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="n">conds_refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
                <span class="n">conds_refs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">conds_refs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span></div>

<div class="viewcode-block" id="DRS.visit"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.visit">[docs]</a>    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">combinator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: Expression.visit()&quot;&quot;&quot;</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">combinator</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRS.visit_structured"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.visit_structured">[docs]</a>    <span class="k">def</span> <span class="nf">visit_structured</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">combinator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: Expression.visit_structured()&quot;&quot;&quot;</span>
        <span class="n">consequent</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">combinator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">)),</span> <span class="n">consequent</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRS.eliminate_equality"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.eliminate_equality">[docs]</a>    <span class="k">def</span> <span class="nf">eliminate_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">):</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">EqualityExpression</span><span class="p">)</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">AbstractVariableExpression</span><span class="p">)</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">AbstractVariableExpression</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">drs</span> <span class="o">=</span> <span class="n">DRS</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">cond</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">variable</span><span class="p">}),</span>
                    <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:],</span>
                    <span class="n">drs</span><span class="o">.</span><span class="n">consequent</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">variable</span> <span class="o">!=</span> <span class="n">cond</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">variable</span><span class="p">:</span>
                    <span class="n">drs</span> <span class="o">=</span> <span class="n">drs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">cond</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">conds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
            <span class="n">new_cond</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">eliminate_equality</span><span class="p">()</span>
            <span class="n">new_cond_simp</span> <span class="o">=</span> <span class="n">new_cond</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_cond_simp</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">new_cond_simp</span><span class="o">.</span><span class="n">refs</span>
                <span class="ow">or</span> <span class="n">new_cond_simp</span><span class="o">.</span><span class="n">conds</span>
                <span class="ow">or</span> <span class="n">new_cond_simp</span><span class="o">.</span><span class="n">consequent</span>
            <span class="p">):</span>
                <span class="n">conds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_cond</span><span class="p">)</span>

        <span class="n">consequent</span> <span class="o">=</span> <span class="n">drs</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">eliminate_equality</span><span class="p">()</span> <span class="k">if</span> <span class="n">drs</span><span class="o">.</span><span class="n">consequent</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">conds</span><span class="p">,</span> <span class="n">consequent</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRS.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DRS.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
                <span class="n">accum</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">AndExpression</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">accum</span><span class="p">:</span>
                <span class="n">accum</span> <span class="o">=</span> <span class="n">ImpExpression</span><span class="p">(</span><span class="n">accum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">accum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">accum</span> <span class="o">=</span> <span class="n">AllExpression</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">accum</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">accum</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot convert DRS with no conditions to FOL.&quot;</span><span class="p">)</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">AndExpression</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_ref_strings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">accum</span> <span class="o">=</span> <span class="n">ExistsExpression</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">accum</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">accum</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">refs_line</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_ref_strings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">))</span>

        <span class="n">cond_lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">cond</span>
            <span class="k">for</span> <span class="n">cond_line</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">cond</span><span class="o">.</span><span class="n">_pretty</span><span class="p">())</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">cond_line</span>
        <span class="p">]</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">refs_line</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">cond_lines</span><span class="p">)))</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot; _&quot;</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">*</span> <span class="n">length</span> <span class="o">+</span> <span class="s2">&quot;_ &quot;</span><span class="p">,</span>
                <span class="s2">&quot;| &quot;</span> <span class="o">+</span> <span class="n">refs_line</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; |&quot;</span><span class="p">,</span>
                <span class="s2">&quot;|-&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">length</span> <span class="o">+</span> <span class="s2">&quot;-|&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;| &quot;</span> <span class="o">+</span> <span class="n">line</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; |&quot;</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">cond_lines</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;|_&quot;</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">*</span> <span class="n">length</span> <span class="o">+</span> <span class="s2">&quot;_|&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DrtBinaryExpression</span><span class="o">.</span><span class="n">_assemble_pretty</span><span class="p">(</span>
                <span class="n">drs</span><span class="p">,</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IMP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">drs</span>

    <span class="k">def</span> <span class="nf">_order_ref_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refs</span><span class="p">):</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ref</span> <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">refs</span><span class="p">]</span>
        <span class="n">ind_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">func_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">event_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">other_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_indvar</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                <span class="n">ind_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_funcvar</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                <span class="n">func_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_eventvar</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                <span class="n">event_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="n">other_vars</span><span class="p">)</span>
            <span class="o">+</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">event_vars</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">int</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]))</span>
            <span class="o">+</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">func_vars</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])))</span>
            <span class="o">+</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ind_vars</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])))</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Defines equality modulo alphabetic variance.</span>
<span class="sd">        If we are comparing \x.M  and \y.N, then check equality of M and N[x/y].&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">refs</span><span class="p">):</span>
                <span class="n">converted_other</span> <span class="o">=</span> <span class="n">other</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">refs</span><span class="p">):</span>
                    <span class="n">varex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
                    <span class="n">converted_other</span> <span class="o">=</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">varex</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">==</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">consequent</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">conds</span>
                <span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">converted_other</span><span class="o">.</span><span class="n">conds</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">,</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">conds</span><span class="p">):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">c1</span> <span class="o">==</span> <span class="n">c2</span><span class="p">):</span>
                            <span class="k">return</span> <span class="kc">False</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>

    <span class="fm">__hash__</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="fm">__hash__</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="s2">&quot;([</span><span class="si">{}</span><span class="s2">],[</span><span class="si">{}</span><span class="s2">])&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_ref_strings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">)),</span>
            <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cond</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">),</span>
        <span class="p">)</span>  <span class="c1"># map(str, self.conds)))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span>
                <span class="o">+</span> <span class="n">drs</span>
                <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="o">+</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IMP</span>
                <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span>
                <span class="o">+</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">drs</span></div>


<div class="viewcode-block" id="DrtVariableExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtVariableExpression">[docs]</a><span class="k">def</span> <span class="nf">DrtVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a factory method that instantiates and returns a subtype of</span>
<span class="sd">    ``DrtAbstractVariableExpression`` appropriate for the given variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_indvar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtIndividualVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_funcvar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtFunctionVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_eventvar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtEventVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DrtConstantExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span></div>


<div class="viewcode-block" id="DrtAbstractVariableExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtAbstractVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtAbstractVariableExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">AbstractVariableExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtAbstractVariableExpression.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtAbstractVariableExpression.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="DrtAbstractVariableExpression.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtAbstractVariableExpression.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span>
        <span class="n">blank</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">blank</span><span class="p">,</span> <span class="n">blank</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">blank</span><span class="p">]</span>

<div class="viewcode-block" id="DrtAbstractVariableExpression.eliminate_equality"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtAbstractVariableExpression.eliminate_equality">[docs]</a>    <span class="k">def</span> <span class="nf">eliminate_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>


<div class="viewcode-block" id="DrtIndividualVariableExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtIndividualVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtIndividualVariableExpression</span><span class="p">(</span>
    <span class="n">DrtAbstractVariableExpression</span><span class="p">,</span> <span class="n">IndividualVariableExpression</span>
<span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="DrtFunctionVariableExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtFunctionVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtFunctionVariableExpression</span><span class="p">(</span>
    <span class="n">DrtAbstractVariableExpression</span><span class="p">,</span> <span class="n">FunctionVariableExpression</span>
<span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="DrtEventVariableExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtEventVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtEventVariableExpression</span><span class="p">(</span>
    <span class="n">DrtIndividualVariableExpression</span><span class="p">,</span> <span class="n">EventVariableExpression</span>
<span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="DrtConstantExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConstantExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtConstantExpression</span><span class="p">(</span><span class="n">DrtAbstractVariableExpression</span><span class="p">,</span> <span class="n">ConstantExpression</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="DrtProposition"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition">[docs]</a><span class="k">class</span> <span class="nc">DrtProposition</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtProposition.__init__"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">drs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drs</span> <span class="o">=</span> <span class="n">drs</span></div>

<div class="viewcode-block" id="DrtProposition.replace"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition.replace">[docs]</a>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="n">variable</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">expression</span><span class="p">,</span> <span class="n">DrtAbstractVariableExpression</span>
            <span class="p">),</span> <span class="s2">&quot;Can only replace a proposition label with a variable&quot;</span>
            <span class="k">return</span> <span class="n">DrtProposition</span><span class="p">(</span>
                <span class="n">expression</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DrtProposition</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">),</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="DrtProposition.eliminate_equality"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition.eliminate_equality">[docs]</a>    <span class="k">def</span> <span class="nf">eliminate_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtProposition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="o">.</span><span class="n">eliminate_equality</span><span class="p">())</span></div>

<div class="viewcode-block" id="DrtProposition.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">recursive</span> <span class="k">else</span> <span class="p">[]</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">variable</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">drs</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">drs</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>

    <span class="fm">__hash__</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="fm">__hash__</span>

<div class="viewcode-block" id="DrtProposition.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">drs_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span>
        <span class="n">blank</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">blank</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">drs_s</span><span class="p">[:</span><span class="mi">1</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">drs_s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">blank</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">drs_s</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DrtProposition.visit"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition.visit">[docs]</a>    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">combinator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: Expression.visit()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">combinator</span><span class="p">([</span><span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="p">)])</span></div>

<div class="viewcode-block" id="DrtProposition.visit_structured"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtProposition.visit_structured">[docs]</a>    <span class="k">def</span> <span class="nf">visit_structured</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">combinator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: Expression.visit_structured()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">combinator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;prop(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="si">}</span><span class="s2">)&quot;</span></div>


<div class="viewcode-block" id="DrtNegatedExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtNegatedExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtNegatedExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">NegatedExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtNegatedExpression.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtNegatedExpression.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">NegatedExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span></div>

<div class="viewcode-block" id="DrtNegatedExpression.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtNegatedExpression.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="n">recursive</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">term_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;__  &quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;  | &quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[</span><span class="mi">4</span><span class="p">:]]</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DrtLambdaExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtLambdaExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtLambdaExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">LambdaExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtLambdaExpression.alpha_convert"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtLambdaExpression.alpha_convert">[docs]</a>    <span class="k">def</span> <span class="nf">alpha_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newvar</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename all occurrences of the variable introduced by this variable</span>
<span class="sd">        binder in the expression to ``newvar``.</span>
<span class="sd">        :param newvar: ``Variable``, for the new variable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">newvar</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">newvar</span><span class="p">),</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DrtLambdaExpression.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtLambdaExpression.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">LambdaExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span>
        <span class="k">while</span> <span class="n">term</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">:</span>
            <span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
            <span class="n">term</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">term</span>
        <span class="n">var_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">)</span> <span class="o">+</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DOT</span>
        <span class="n">term_lines</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span>
        <span class="n">blank</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_string</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="n">blank</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[:</span><span class="mi">1</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot; \  &quot;</span> <span class="o">+</span> <span class="n">blank</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot; /\ &quot;</span> <span class="o">+</span> <span class="n">var_string</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="n">blank</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">term_lines</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DrtLambdaExpression.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtLambdaExpression.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">recursive</span> <span class="k">else</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">]</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="DrtBinaryExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtBinaryExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtBinaryExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">BinaryExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtBinaryExpression.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtBinaryExpression.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">recursive</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtBinaryExpression</span><span class="o">.</span><span class="n">_assemble_pretty</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getOp</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_assemble_pretty</span><span class="p">(</span><span class="n">first_lines</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">second_lines</span><span class="p">):</span>
        <span class="n">max_lines</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_lines</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">second_lines</span><span class="p">))</span>
        <span class="n">first_lines</span> <span class="o">=</span> <span class="n">_pad_vertically</span><span class="p">(</span><span class="n">first_lines</span><span class="p">,</span> <span class="n">max_lines</span><span class="p">)</span>
        <span class="n">second_lines</span> <span class="o">=</span> <span class="n">_pad_vertically</span><span class="p">(</span><span class="n">second_lines</span><span class="p">,</span> <span class="n">max_lines</span><span class="p">)</span>
        <span class="n">blank</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
        <span class="n">first_second_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">first_lines</span><span class="p">,</span> <span class="n">second_lines</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">first_line</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">blank</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">second_line</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="k">for</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">second_line</span> <span class="ow">in</span> <span class="n">first_second_lines</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">first_line</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">op</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">second_line</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
                <span class="k">for</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">second_line</span> <span class="ow">in</span> <span class="n">first_second_lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">first_line</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">blank</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">second_line</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="k">for</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">second_line</span> <span class="ow">in</span> <span class="n">first_second_lines</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subex</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">subex</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span></div>


<div class="viewcode-block" id="DrtBooleanExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtBooleanExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtBooleanExpression</span><span class="p">(</span><span class="n">DrtBinaryExpression</span><span class="p">,</span> <span class="n">BooleanExpression</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="DrtOrExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtOrExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtOrExpression</span><span class="p">(</span><span class="n">DrtBooleanExpression</span><span class="p">,</span> <span class="n">OrExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtOrExpression.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtOrExpression.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span></div>

    <span class="k">def</span> <span class="nf">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subex</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subex</span><span class="p">,</span> <span class="n">DrtOrExpression</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">subex</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">DrtBooleanExpression</span><span class="o">.</span><span class="n">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subex</span><span class="p">)</span></div>


<div class="viewcode-block" id="DrtEqualityExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtEqualityExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtEqualityExpression</span><span class="p">(</span><span class="n">DrtBinaryExpression</span><span class="p">,</span> <span class="n">EqualityExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtEqualityExpression.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtEqualityExpression.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">EqualityExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="DrtConcatenation"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation">[docs]</a><span class="k">class</span> <span class="nc">DrtConcatenation</span><span class="p">(</span><span class="n">DrtBooleanExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;DRS of the form &#39;(DRS + DRS)&#39;&quot;&quot;&quot;</span>

<div class="viewcode-block" id="DrtConcatenation.__init__"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">consequent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">DrtBooleanExpression</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span></div>

<div class="viewcode-block" id="DrtConcatenation.replace"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.replace">[docs]</a>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace all instances of variable v with expression E in self,</span>
<span class="sd">        where v is free in self.&quot;&quot;&quot;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span>
        <span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span>

        <span class="c1"># If variable is bound</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_refs</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">replace_bound</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span>
                <span class="p">)</span>
                <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">consequent</span><span class="p">:</span>
                    <span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                        <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">alpha_convert</span><span class="p">:</span>
                <span class="c1"># alpha convert every ref that is free in &#39;expression&#39;</span>
                <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span> <span class="o">&amp;</span> <span class="n">expression</span><span class="o">.</span><span class="n">free</span><span class="p">():</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">unique_variable</span><span class="p">(</span><span class="n">ref</span><span class="p">))</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>
                    <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">consequent</span><span class="p">:</span>
                        <span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>

            <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">consequent</span><span class="p">:</span>
                <span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">,</span> <span class="n">alpha_convert</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">consequent</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtConcatenation.eliminate_equality"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.eliminate_equality">[docs]</a>    <span class="k">def</span> <span class="nf">eliminate_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: at some point.  for now, simplify.</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drs</span><span class="p">,</span> <span class="n">DrtConcatenation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">drs</span><span class="o">.</span><span class="n">eliminate_equality</span><span class="p">()</span></div>

<div class="viewcode-block" id="DrtConcatenation.simplify"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.simplify">[docs]</a>    <span class="k">def</span> <span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
            <span class="c1"># For any ref that is in both &#39;first&#39; and &#39;second&#39;</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">second</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)):</span>
                <span class="c1"># alpha convert the ref in &#39;second&#39; to prevent collision</span>
                <span class="n">newvar</span> <span class="o">=</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">unique_variable</span><span class="p">(</span><span class="n">ref</span><span class="p">))</span>
                <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">newvar</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">refs</span> <span class="o">+</span> <span class="n">second</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">first</span><span class="o">.</span><span class="n">conds</span> <span class="o">+</span> <span class="n">second</span><span class="o">.</span><span class="n">conds</span><span class="p">,</span> <span class="n">consequent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">consequent</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtConcatenation.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="n">refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="n">recursive</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="n">recursive</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="ow">and</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="n">refs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">refs</span></div>

<div class="viewcode-block" id="DrtConcatenation.getOp"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.getOp">[docs]</a>    <span class="k">def</span> <span class="nf">getOp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DRS_CONC</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Defines equality modulo alphabetic variance.</span>
<span class="sd">        If we are comparing \x.M  and \y.N, then check equality of M and N[x/y].&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DrtConcatenation</span><span class="p">):</span>
            <span class="n">self_refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_refs</span><span class="p">()</span>
            <span class="n">other_refs</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_refs</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">self_refs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_refs</span><span class="p">):</span>
                <span class="n">converted_other</span> <span class="o">=</span> <span class="n">other</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">self_refs</span><span class="p">,</span> <span class="n">other_refs</span><span class="p">):</span>
                    <span class="n">varex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
                    <span class="n">converted_other</span> <span class="o">=</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">varex</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">first</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">second</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">==</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">consequent</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>

    <span class="fm">__hash__</span> <span class="o">=</span> <span class="n">DrtBooleanExpression</span><span class="o">.</span><span class="fm">__hash__</span>

<div class="viewcode-block" id="DrtConcatenation.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">AndExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">ImpExpression</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">e</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="n">DrtBinaryExpression</span><span class="o">.</span><span class="n">_assemble_pretty</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getOp</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="n">drs</span> <span class="o">=</span> <span class="n">DrtBinaryExpression</span><span class="o">.</span><span class="n">_assemble_pretty</span><span class="p">(</span>
                <span class="n">drs</span><span class="p">,</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IMP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">drs</span>

    <span class="k">def</span> <span class="nf">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subex</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subex</span><span class="p">,</span> <span class="n">DrtConcatenation</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">subex</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">DrtBooleanExpression</span><span class="o">.</span><span class="n">_pretty_subex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subex</span><span class="p">)</span>

<div class="viewcode-block" id="DrtConcatenation.visit"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtConcatenation.visit">[docs]</a>    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">combinator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: Expression.visit()&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">combinator</span><span class="p">(</span>
                <span class="p">[</span><span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">)]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">combinator</span><span class="p">([</span><span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">)])</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_subex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_subex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="n">Tokens</span><span class="o">.</span><span class="n">OPEN</span> <span class="o">+</span> <span class="n">first</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOp</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">second</span> <span class="o">+</span> <span class="n">Tokens</span><span class="o">.</span><span class="n">CLOSE</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span>
                <span class="o">+</span> <span class="n">drs</span>
                <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="o">+</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IMP</span>
                <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span>
                <span class="o">+</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">drs</span>

    <span class="k">def</span> <span class="nf">_str_subex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subex</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">subex</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subex</span><span class="p">,</span> <span class="n">DrtConcatenation</span><span class="p">)</span> <span class="ow">and</span> <span class="n">subex</span><span class="o">.</span><span class="n">consequent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="DrtApplicationExpression"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtApplicationExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtApplicationExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">ApplicationExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtApplicationExpression.fol"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtApplicationExpression.fol">[docs]</a>    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ApplicationExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span></div>

<div class="viewcode-block" id="DrtApplicationExpression.get_refs"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrtApplicationExpression.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">recursive</span>
            <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">function</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncurry</span><span class="p">()</span>
        <span class="n">function_lines</span> <span class="o">=</span> <span class="n">function</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span>
        <span class="n">args_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">_pretty</span><span class="p">()</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">max_lines</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">[</span><span class="n">function_lines</span><span class="p">]</span> <span class="o">+</span> <span class="n">args_lines</span><span class="p">))</span>
        <span class="n">function_lines</span> <span class="o">=</span> <span class="n">_pad_vertically</span><span class="p">(</span><span class="n">function_lines</span><span class="p">,</span> <span class="n">max_lines</span><span class="p">)</span>
        <span class="n">args_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">_pad_vertically</span><span class="p">(</span><span class="n">arg_lines</span><span class="p">,</span> <span class="n">max_lines</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg_lines</span> <span class="ow">in</span> <span class="n">args_lines</span><span class="p">]</span>
        <span class="n">func_args_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">function_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">args_lines</span><span class="p">))))</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">[</span>
                <span class="n">func_line</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="k">for</span> <span class="n">func_line</span><span class="p">,</span> <span class="n">args_line</span> <span class="ow">in</span> <span class="n">func_args_lines</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="n">func_line</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
                <span class="k">for</span> <span class="n">func_line</span><span class="p">,</span> <span class="n">args_line</span> <span class="ow">in</span> <span class="n">func_args_lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="n">func_line</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="k">for</span> <span class="n">func_line</span><span class="p">,</span> <span class="n">args_line</span> <span class="ow">in</span> <span class="n">func_args_lines</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="p">]</span>
        <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_pad_vertically</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">max_lines</span><span class="p">):</span>
    <span class="n">pad_line</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">lines</span> <span class="o">+</span> <span class="n">pad_line</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_lines</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>


<div class="viewcode-block" id="PossibleAntecedents"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.PossibleAntecedents">[docs]</a><span class="k">class</span> <span class="nc">PossibleAntecedents</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">DrtExpression</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
<div class="viewcode-block" id="PossibleAntecedents.free"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.PossibleAntecedents.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set of free variables.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="PossibleAntecedents.replace"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.PossibleAntecedents.replace">[docs]</a>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace all instances of variable v with expression E in self,</span>
<span class="sd">        where v is free in self.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">PossibleAntecedents</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">variable</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="k">def</span> <span class="nf">_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span>
        <span class="n">blank</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">blank</span><span class="p">,</span> <span class="n">blank</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">it</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span></div>


<div class="viewcode-block" id="AnaphoraResolutionException"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.AnaphoraResolutionException">[docs]</a><span class="k">class</span> <span class="nc">AnaphoraResolutionException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="resolve_anaphora"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.resolve_anaphora">[docs]</a><span class="k">def</span> <span class="nf">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">ApplicationExpression</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expression</span><span class="o">.</span><span class="n">is_pronoun_function</span><span class="p">():</span>
            <span class="n">possible_antecedents</span> <span class="o">=</span> <span class="n">PossibleAntecedents</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ancestor</span> <span class="ow">in</span> <span class="n">trail</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">ancestor</span><span class="o">.</span><span class="n">get_refs</span><span class="p">():</span>
                    <span class="n">refex</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>

                    <span class="c1"># ==========================================================</span>
                    <span class="c1"># Don&#39;t allow resolution to itself or other types</span>
                    <span class="c1"># ==========================================================</span>
                    <span class="k">if</span> <span class="n">refex</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">expression</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                        <span class="n">refex</span> <span class="o">==</span> <span class="n">expression</span><span class="o">.</span><span class="n">argument</span>
                    <span class="p">):</span>
                        <span class="n">possible_antecedents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refex</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_antecedents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">resolution</span> <span class="o">=</span> <span class="n">possible_antecedents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">resolution</span> <span class="o">=</span> <span class="n">possible_antecedents</span>
            <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="n">make_EqualityExpression</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r_function</span> <span class="o">=</span> <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">])</span>
            <span class="n">r_argument</span> <span class="o">=</span> <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">r_function</span><span class="p">,</span> <span class="n">r_argument</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
        <span class="n">r_conds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">expression</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
            <span class="n">r_cond</span> <span class="o">=</span> <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">])</span>

            <span class="c1"># if the condition is of the form &#39;(x = [])&#39; then raise exception</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r_cond</span><span class="p">,</span> <span class="n">EqualityExpression</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r_cond</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">PossibleAntecedents</span><span class="p">):</span>
                    <span class="c1"># Reverse the order so that the variable is on the left</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">r_cond</span><span class="o">.</span><span class="n">first</span>
                    <span class="n">r_cond</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">r_cond</span><span class="o">.</span><span class="n">second</span>
                    <span class="n">r_cond</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">temp</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r_cond</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">PossibleAntecedents</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">r_cond</span><span class="o">.</span><span class="n">second</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">AnaphoraResolutionException</span><span class="p">(</span>
                            <span class="s2">&quot;Variable &#39;</span><span class="si">%s</span><span class="s2">&#39; does not &quot;</span>
                            <span class="s2">&quot;resolve to anything.&quot;</span> <span class="o">%</span> <span class="n">r_cond</span><span class="o">.</span><span class="n">first</span>
                        <span class="p">)</span>

            <span class="n">r_conds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_cond</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expression</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="n">consequent</span> <span class="o">=</span> <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">consequent</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">consequent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">r_conds</span><span class="p">,</span> <span class="n">consequent</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">AbstractVariableExpression</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expression</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">NegatedExpression</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">term</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">])</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DrtConcatenation</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expression</span><span class="o">.</span><span class="n">consequent</span><span class="p">:</span>
            <span class="n">consequent</span> <span class="o">=</span> <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">consequent</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">consequent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">]),</span>
            <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">]),</span>
            <span class="n">consequent</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">BinaryExpression</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">]),</span>
            <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">]),</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">LambdaExpression</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">expression</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">term</span><span class="p">,</span> <span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="n">expression</span><span class="p">])</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DrsDrawer"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrsDrawer">[docs]</a><span class="k">class</span> <span class="nc">DrsDrawer</span><span class="p">:</span>
    <span class="n">BUFFER</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Space between elements</span>
    <span class="n">TOPSPACE</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Space above whole DRS</span>
    <span class="n">OUTERSPACE</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Space to the left, right, and bottom of the while DRS</span>

<div class="viewcode-block" id="DrsDrawer.__init__"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrsDrawer.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">,</span> <span class="n">size_canvas</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">canvas</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param drs: ``DrtExpression``, The DRS to be drawn</span>
<span class="sd">        :param size_canvas: bool, True if the canvas size should be the exact size of the DRS</span>
<span class="sd">        :param canvas: ``Canvas`` The canvas on which to draw the DRS.  If none is given, create a new canvas.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">master</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">canvas</span><span class="p">:</span>
            <span class="n">master</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
            <span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;DRT&quot;</span><span class="p">)</span>

            <span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;helvetica&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">size_canvas</span><span class="p">:</span>
                <span class="n">canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">canvas</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">font</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas</span>
                <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit</span><span class="p">(</span><span class="n">drs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OUTERSPACE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOPSPACE</span><span class="p">)</span>

                <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">right</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">OUTERSPACE</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">bottom</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">OUTERSPACE</span>
                <span class="n">canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># , bg=&#39;white&#39;)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

            <span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
            <span class="n">canvas</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">font</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drs</span> <span class="o">=</span> <span class="n">drs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">master</span></div>

    <span class="k">def</span> <span class="nf">_get_text_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the height of a line of text&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">metrics</span><span class="p">(</span><span class="s2">&quot;linespace&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="DrsDrawer.draw"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.DrsDrawer.draw">[docs]</a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">OUTERSPACE</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">TOPSPACE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw the DRS&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">in_idle</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the bottom-rightmost point without actually drawing the item</span>

<span class="sd">        :param expression: the item to visit</span>
<span class="sd">        :param x: the top of the current drawing area</span>
<span class="sd">        :param y: the left side of the current drawing area</span>
<span class="sd">        :return: the bottom-rightmost point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit_command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the given item at the given location</span>

<span class="sd">        :param item: the item to draw</span>
<span class="sd">        :param x: the top of the current drawing area</span>
<span class="sd">        :param y: the left side of the current drawing area</span>
<span class="sd">        :return: the bottom-rightmost point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;nw&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">font</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="c1"># item is the lower-right of a box</span>
            <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="n">item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
            <span class="n">horiz_line_y</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_height</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BUFFER</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span>  <span class="c1"># the line separating refs from conds</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">horiz_line_y</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">horiz_line_y</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit_command</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_visit_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the bottom-rightmost point without actually drawing the item</span>

<span class="sd">        :param item: the item to visit</span>
<span class="sd">        :param x: the top of the current drawing area</span>
<span class="sd">        :param y: the left side of the current drawing area</span>
<span class="sd">        :return: the bottom-rightmost point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_height</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span>

    <span class="k">def</span> <span class="nf">_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param expression: the expression to handle</span>
<span class="sd">        :param command: the function to apply, either _draw_command or _visit_command</span>
<span class="sd">        :param x: the top of the current drawing area</span>
<span class="sd">        :param y: the left side of the current drawing area</span>
<span class="sd">        :return: the bottom-rightmost point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit_command</span><span class="p">:</span>
            <span class="c1"># if we don&#39;t need to draw the item, then we can use the cached values</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># attempt to retrieve cached values</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">_drawing_width</span> <span class="o">+</span> <span class="n">x</span>
                <span class="n">bottom</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">_drawing_height</span> <span class="o">+</span> <span class="n">y</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="c1"># the values have not been cached yet, so compute them</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DrtAbstractVariableExpression</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_VariableExpression</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_DRS</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DrtNegatedExpression</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_NegatedExpression</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DrtLambdaExpression</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_LambdaExpression</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">BinaryExpression</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_BinaryExpression</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_ApplicationExpression</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">PossibleAntecedents</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_VariableExpression</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">DrtProposition</span><span class="p">):</span>
            <span class="n">factory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_DrtProposition</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># cache the values</span>
        <span class="n">expression</span><span class="o">.</span><span class="n">_drawing_width</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">x</span>
        <span class="n">expression</span><span class="o">.</span><span class="n">_drawing_height</span> <span class="o">=</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">y</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_VariableExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">command</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">expression</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_NegatedExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># Find the width of the negation symbol</span>
        <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit_command</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">NOT</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle term</span>
        <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">term</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># Handle variables now that we know the y-coordinate</span>
        <span class="n">command</span><span class="p">(</span>
            <span class="n">DrtTokens</span><span class="o">.</span><span class="n">NOT</span><span class="p">,</span>
            <span class="n">x</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_height</span><span class="p">()),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_DRS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUFFER</span>  <span class="c1"># indent the left side</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUFFER</span>  <span class="c1"># indent the top</span>

        <span class="c1"># Handle Discourse Referents</span>
        <span class="k">if</span> <span class="n">expression</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span>
            <span class="n">refs</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">expression</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">refs</span> <span class="o">=</span> <span class="s2">&quot;     &quot;</span>
        <span class="p">(</span><span class="n">max_right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="n">refs</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
        <span class="n">bottom</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUFFER</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="c1"># Handle Conditions</span>
        <span class="k">if</span> <span class="n">expression</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">expression</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
                <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
                <span class="n">max_right</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_right</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
                <span class="n">bottom</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUFFER</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bottom</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_height</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUFFER</span>

        <span class="c1"># Handle Box</span>
        <span class="n">max_right</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUFFER</span>
        <span class="k">return</span> <span class="n">command</span><span class="p">((</span><span class="n">max_right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_ApplicationExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">function</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">uncurry</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtAbstractVariableExpression</span><span class="p">):</span>
            <span class="c1"># It&#39;s not a predicate expression (&quot;P(x,y)&quot;), so leave arguments curried</span>
            <span class="n">function</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">function</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">expression</span><span class="o">.</span><span class="n">argument</span><span class="p">]</span>

        <span class="c1"># Get the max bottom of any element on the line</span>
        <span class="n">function_bottom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">max_bottom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="p">[</span><span class="n">function_bottom</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_visit</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">line_height</span> <span class="o">=</span> <span class="n">max_bottom</span> <span class="o">-</span> <span class="n">y</span>

        <span class="c1"># Handle &#39;function&#39;</span>
        <span class="n">function_drawing_top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">line_height</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">_drawing_height</span>
        <span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">function_drawing_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle open paren</span>
        <span class="n">centred_string_top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">line_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_height</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">centred_string_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle each arg</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="n">arg_drawing_top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span>
                <span class="n">y</span><span class="p">,</span> <span class="n">line_height</span><span class="p">,</span> <span class="n">arg</span><span class="o">.</span><span class="n">_drawing_height</span>
            <span class="p">)</span>
            <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">arg_drawing_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                <span class="c1"># since it&#39;s not the last arg, add a comma</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">COMMA</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">centred_string_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle close paren</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">centred_string_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">max_bottom</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_LambdaExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># Find the width of the lambda symbol and abstracted variables</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">LAMBDA</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">expression</span><span class="o">.</span><span class="n">variable</span> <span class="o">+</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DOT</span>
        <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit_command</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle term</span>
        <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">term</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># Handle variables now that we know the y-coordinate</span>
        <span class="n">command</span><span class="p">(</span>
            <span class="n">variables</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_height</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_BinaryExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># Get the full height of the line, based on the operands</span>
        <span class="n">first_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">second_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visit</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">line_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">first_height</span><span class="p">,</span> <span class="n">second_height</span><span class="p">)</span>

        <span class="c1"># Handle open paren</span>
        <span class="n">centred_string_top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">line_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_height</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">centred_string_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle the first operand</span>
        <span class="n">first_height</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">_drawing_height</span>
        <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">first_bottom</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span>
            <span class="n">expression</span><span class="o">.</span><span class="n">first</span><span class="p">,</span>
            <span class="n">command</span><span class="p">,</span>
            <span class="n">right</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">line_height</span><span class="p">,</span> <span class="n">first_height</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Handle the operator</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">expression</span><span class="o">.</span><span class="n">getOp</span><span class="p">(),</span> <span class="n">right</span><span class="p">,</span> <span class="n">centred_string_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle the second operand</span>
        <span class="n">second_height</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">_drawing_height</span>
        <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">second_bottom</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span>
            <span class="n">expression</span><span class="o">.</span><span class="n">second</span><span class="p">,</span>
            <span class="n">command</span><span class="p">,</span>
            <span class="n">right</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_centered_top</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">line_height</span><span class="p">,</span> <span class="n">second_height</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Handle close paren</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">centred_string_top</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">first_bottom</span><span class="p">,</span> <span class="n">second_bottom</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_handle_DrtProposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># Find the width of the negation symbol</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Handle term</span>
        <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">term</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_centered_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">full_height</span><span class="p">,</span> <span class="n">item_height</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the y-coordinate of the point that a figure should start at if</span>
<span class="sd">        its height is &#39;item_height&#39; and it needs to be centered in an area that</span>
<span class="sd">        starts at &#39;top&#39; and is &#39;full_height&#39; tall.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">top</span> <span class="o">+</span> <span class="p">(</span><span class="n">full_height</span> <span class="o">-</span> <span class="n">item_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span></div>


<div class="viewcode-block" id="demo"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.demo">[docs]</a><span class="k">def</span> <span class="nf">demo</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s2">&quot;TEST PARSE&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">dexpr</span> <span class="o">=</span> <span class="n">DrtExpression</span><span class="o">.</span><span class="n">fromstring</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([x,y],[sees(x,y)])&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([x],[man(x), walks(x)])&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\x.\y.([],[sees(x,y)])&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\x.([],[walks(x)])(john)&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([x],[walks(x)]) + ([y],[runs(y)]))&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([],[walks(x)]) -&gt; ([],[runs(x)]))&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([x],[PRO(x), sees(John,x)])&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([x],[man(x), -([],[walks(x)])])&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([],[(([x],[man(x)]) -&gt; ([],[walks(x)]))])&quot;</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s2">&quot;Test fol()&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([x,y],[sees(x,y)])&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s2">&quot;Test alpha conversion and lambda expression equality&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">e1</span> <span class="o">=</span> <span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\x.([],[P(x)])&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
    <span class="n">e2</span> <span class="o">=</span> <span class="n">e1</span><span class="o">.</span><span class="n">alpha_convert</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e1</span> <span class="o">==</span> <span class="n">e2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s2">&quot;Test resolve_anaphora()&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([x,y,z],[dog(x), cat(y), walks(z), PRO(z)])&quot;</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([],[(([x],[dog(x)]) -&gt; ([y],[walks(y), PRO(y)]))])&quot;</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">resolve_anaphora</span><span class="p">(</span><span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([x,y],[]) + ([],[PRO(x)]))&quot;</span><span class="p">)))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s2">&quot;Test pretty_print()&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([],[])&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
    <span class="n">dexpr</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;([],[([x],[big(x), dog(x)]) -&gt; ([],[bark(x)]) -([x],[walk(x)])])&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
    <span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([x,y],[x=y]) + ([z],[dog(z), walk(z)])&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
    <span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([],[([x],[]) | ([y],[]) | ([z],[dog(z), walk(z)])])&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
    <span class="n">dexpr</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\P.\Q.(([x],[]) + P(x) + Q(x))(\x.([],[dog(x)]))&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span></div>


<div class="viewcode-block" id="test_draw"><a class="viewcode-back" href="../../../api/nltk.sem.drt.html#nltk.sem.test_draw">[docs]</a><span class="k">def</span> <span class="nf">test_draw</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">Tk</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;tkinter is required, but it&#39;s not available.&quot;</span><span class="p">)</span>

    <span class="n">expressions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">r</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([],[])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([x],[])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([x],[man(x)])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([x,y],[sees(x,y)])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([x],[man(x), walks(x)])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;\x.([],[man(x), walks(x)])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;\x y.([],[sees(x,y)])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([],[(([],[walks(x)]) + ([],[runs(x)]))])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([x],[man(x), -([],[walks(x)])])&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;([],[(([x],[man(x)]) -&gt; ([],[walks(x)]))])&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">DrtExpression</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demo</span><span class="p">()</span>
</pre></div>

        </div>
      </div>

    </div>

<footer>
    <div id="footer-info">
        <ul id="build-details">
            

            
                <li class="footer-element">
                    <a href="https://github.com/nltk/nltk/tree/3.8.1">3.8.1</a>
                </li>
            

            
                <li class="footer-element">
                    Jan 02, 2023
                </li>
            
        </ul>

        
            <div id="copyright">
                &copy; 2023, NLTK Project
            </div>
        

        <div id="credit">
            created with <a href="http://sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/tomaarsen/nltk_theme">NLTK Theme</a>
        </div>
    </div>
</footer> 

</div>

</body>
</html>
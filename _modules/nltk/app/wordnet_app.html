<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2D2D2D" />
  
  <title>NLTK :: nltk.app.wordnet_app</title>
  

  <link rel="stylesheet" href="../../../_static/css/nltk_theme.css"/>
  <link rel="stylesheet" href="../../../_static/css/custom.css"/>

  <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
  

  <script src="https://email.tl.fortawesome.com/c/eJxNjUEOgyAQAF8jR7Kw6wIHDh7sP1Cw2mgxgmn6-3JsMqc5zEQfE8dkxOY1KKMUOI3ACFKRJpSW2AAp7ontYIaxI6i7XPJVwyeVfCQ550Os3jLrGSNOLgbdAy6s0PBk2TFNjEbsfq31LB0OnX407pJa5v2faRadwSW63mn5KuLyR9j2tgx3zecanl-55R_-jjPs"></script> 
</head>

<body>
  <div id="nltk-theme-container">
    <header>
      <div id="logo-container">
          
          <h1>
            <a href="../../../index.html">NLTK</a>
          </h1>
          
      </div>
      <div id="project-container">
        
        <h1>Documentation</h1>
        
      </div>

      <a id="menu-toggle" class="fa fa-bars" aria-hidden="true"></a>

      <script type="text/javascript">
        $("#menu-toggle").click(function() {
          $("#menu-toggle").toggleClass("toggled");
          $("#side-menu-container").slideToggle(300);
        });
      </script>
    </header>

    <div id="content-container">

      <div id="side-menu-container">

        <div id="search" role="search">
        <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
            <input type="text" name="q" placeholder="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
</div>

        <div id="side-menu" role="navigation">
          
  
    
  
  
    <p class="caption" role="heading"><span class="caption-text">NLTK Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/nltk.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto.html">Example Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../py-modindex.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/wiki">Wiki</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/wiki/FAQ">FAQ</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/issues">Open Issues</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk">NLTK on GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing NLTK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data.html">Installing NLTK Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../news.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute.html">Contributing to NLTK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../team.html">NLTK Team</a></li>
</ul>

  

        </div>

        
      </div>

      <div id="main-content-container">
        <div id="main-content" role="main">
          
  <h1>Source code for nltk.app.wordnet_app</h1><div class="highlight"><pre>
<span></span><span class="c1"># Natural Language Toolkit: WordNet Browser Application</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2001-2023 NLTK Project</span>
<span class="c1"># Author: Jussi Salmela &lt;jtsalmela@users.sourceforge.net&gt;</span>
<span class="c1">#         Paul Bone &lt;pbone@students.csse.unimelb.edu.au&gt;</span>
<span class="c1"># URL: &lt;https://www.nltk.org/&gt;</span>
<span class="c1"># For license information, see LICENSE.TXT</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A WordNet Browser application which launches the default browser</span>
<span class="sd">(if it is not already running) and opens a new tab with a connection</span>
<span class="sd">to http://localhost:port/ .  It also starts an HTTP server on the</span>
<span class="sd">specified port and begins serving browser requests.  The default</span>
<span class="sd">port is 8000.  (For command-line help, run &quot;python wordnet -h&quot;)</span>
<span class="sd">This application requires that the user&#39;s web browser supports</span>
<span class="sd">Javascript.</span>

<span class="sd">BrowServer is a server for browsing the NLTK Wordnet database It first</span>
<span class="sd">launches a browser client to be used for browsing and then starts</span>
<span class="sd">serving the requests of that and maybe other clients</span>

<span class="sd">Usage::</span>

<span class="sd">    browserver.py -h</span>
<span class="sd">    browserver.py [-s] [-p &lt;port&gt;]</span>

<span class="sd">Options::</span>

<span class="sd">    -h or --help</span>
<span class="sd">        Display this help message.</span>

<span class="sd">    -l &lt;file&gt; or --log-file &lt;file&gt;</span>
<span class="sd">        Logs messages to the given file, If this option is not specified</span>
<span class="sd">        messages are silently dropped.</span>

<span class="sd">    -p &lt;port&gt; or --port &lt;port&gt;</span>
<span class="sd">        Run the web server on this TCP port, defaults to 8000.</span>

<span class="sd">    -s or --server-mode</span>
<span class="sd">        Do not start a web browser, and do not allow a user to</span>
<span class="sd">        shutdown the server through the web interface.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># TODO: throughout this package variable names and docstrings need</span>
<span class="c1"># modifying to be compliant with NLTK&#39;s coding standards.  Tests also</span>
<span class="c1"># need to be develop to ensure this continues to work in the face of</span>
<span class="c1"># changes to other NLTK packages.</span>

<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">getopt</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">BaseHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>

<span class="c1"># Allow this program to run inside the NLTK source tree.</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">unquote_plus</span>

<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">wordnet</span> <span class="k">as</span> <span class="n">wn</span>
<span class="kn">from</span> <span class="nn">nltk.corpus.reader.wordnet</span> <span class="kn">import</span> <span class="n">Lemma</span><span class="p">,</span> <span class="n">Synset</span>

<span class="n">firstClient</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># True if we&#39;re not also running a web browser.  The value f server_mode</span>
<span class="c1"># gets set by demo().</span>
<span class="n">server_mode</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># If set this is a file object for writing log messages.</span>
<span class="n">logfile</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">MyServerHandler</span><span class="p">(</span><span class="n">BaseHTTPRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do_HEAD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_head</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">firstClient</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">unquote_plus</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;SHUTDOWN THE SERVER&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">server_mode</span><span class="p">:</span>
                <span class="n">page</span> <span class="o">=</span> <span class="s2">&quot;Server must be killed with SIGTERM.&quot;</span>
                <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/plain&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server shutting down!&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">sp</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># First request.</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/html&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">server_mode</span> <span class="ow">and</span> <span class="n">firstClient</span><span class="p">:</span>
                <span class="n">firstClient</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">page</span> <span class="o">=</span> <span class="n">get_static_index_page</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">page</span> <span class="o">=</span> <span class="n">get_static_index_page</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span>

        <span class="k">elif</span> <span class="n">sp</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.html&quot;</span><span class="p">):</span>  <span class="c1"># Trying to fetch a HTML file TODO:</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/html&quot;</span>
            <span class="n">usp</span> <span class="o">=</span> <span class="n">unquote_plus</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">usp</span> <span class="o">==</span> <span class="s2">&quot;NLTK Wordnet Browser Database Info.html&quot;</span><span class="p">:</span>
                <span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;* Database Info *&quot;</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">usp</span><span class="p">):</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">usp</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
                        <span class="n">page</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">page</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">html_header</span> <span class="o">%</span> <span class="n">word</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;p&gt;The database info file:&quot;</span>
                        <span class="s2">&quot;&lt;p&gt;&lt;b&gt;&quot;</span>
                        <span class="o">+</span> <span class="n">usp</span>
                        <span class="o">+</span> <span class="s2">&quot;&lt;/b&gt;&quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;&lt;p&gt;was not found. Run this:&quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;&lt;p&gt;&lt;b&gt;python dbinfo_html.py&lt;/b&gt;&quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;&lt;p&gt;to produce it.&quot;</span>
                        <span class="o">+</span> <span class="n">html_trailer</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Handle files here.</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">sp</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">page</span> <span class="o">=</span> <span class="n">get_static_page_by_path</span><span class="p">(</span><span class="n">usp</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                    <span class="n">page</span> <span class="o">=</span> <span class="s2">&quot;Internal error: Path for static page &#39;</span><span class="si">%s</span><span class="s2">&#39; is unknown&quot;</span> <span class="o">%</span> <span class="n">usp</span>
                    <span class="c1"># Set type to plain to prevent XSS by printing the path as HTML</span>
                    <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/plain&quot;</span>
        <span class="k">elif</span> <span class="n">sp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;search&quot;</span><span class="p">):</span>
            <span class="c1"># This doesn&#39;t seem to work with MWEs.</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/html&quot;</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
            <span class="n">word</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;nextWord&quot;</span><span class="p">)</span>
            <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">page</span><span class="p">,</span> <span class="n">word</span> <span class="o">=</span> <span class="n">page_from_word</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lookup_&quot;</span><span class="p">):</span>
            <span class="c1"># TODO add a variation of this that takes a non ecoded word or MWE.</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/html&quot;</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;lookup_&quot;</span><span class="p">)</span> <span class="p">:]</span>
            <span class="n">page</span><span class="p">,</span> <span class="n">word</span> <span class="o">=</span> <span class="n">page_from_href</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sp</span> <span class="o">==</span> <span class="s2">&quot;start_page&quot;</span><span class="p">:</span>
            <span class="c1"># if this is the first request we should display help</span>
            <span class="c1"># information, and possibly set a default word.</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/html&quot;</span>
            <span class="n">page</span><span class="p">,</span> <span class="n">word</span> <span class="o">=</span> <span class="n">page_from_word</span><span class="p">(</span><span class="s2">&quot;wordnet&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;text/plain&quot;</span>
            <span class="n">page</span> <span class="o">=</span> <span class="s2">&quot;Could not parse request: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">sp</span>

        <span class="c1"># Send result.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_head</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">send_head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_header</span><span class="p">(</span><span class="s2">&quot;Content-type&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_headers</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">log_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">logfile</span>

        <span class="k">if</span> <span class="n">logfile</span><span class="p">:</span>
            <span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> - - [</span><span class="si">%s</span><span class="s2">] </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address_string</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_date_time_string</span><span class="p">(),</span> <span class="nb">format</span> <span class="o">%</span> <span class="n">args</span><span class="p">)</span>
            <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_unique_counter_from_url</span><span class="p">(</span><span class="n">sp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract the unique counter from the URL if it has one.  Otherwise return</span>
<span class="sd">    null.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;%23&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="p">[(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="p">:])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">wnb</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">runBrowser</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logfilename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run NLTK Wordnet Browser Server.</span>

<span class="sd">    :param port: The port number for the server to listen on, defaults to</span>
<span class="sd">                 8000</span>
<span class="sd">    :type  port: int</span>

<span class="sd">    :param runBrowser: True to start a web browser and point it at the web</span>
<span class="sd">                       server.</span>
<span class="sd">    :type  runBrowser: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The webbrowser module is unpredictable, typically it blocks if it uses</span>
    <span class="c1"># a console web browser, and doesn&#39;t block if it uses a GUI webbrowser,</span>
    <span class="c1"># so we need to force it to have a clear correct behaviour.</span>
    <span class="c1">#</span>
    <span class="c1"># Normally the server should run for as long as the user wants. they</span>
    <span class="c1"># should idealy be able to control this from the UI by closing the</span>
    <span class="c1"># window or tab.  Second best would be clicking a button to say</span>
    <span class="c1"># &#39;Shutdown&#39; that first shutsdown the server and closes the window or</span>
    <span class="c1"># tab, or exits the text-mode browser.  Both of these are unfreasable.</span>
    <span class="c1">#</span>
    <span class="c1"># The next best alternative is to start the server, have it close when</span>
    <span class="c1"># it receives SIGTERM (default), and run the browser as well.  The user</span>
    <span class="c1"># may have to shutdown both programs.</span>
    <span class="c1">#</span>
    <span class="c1"># Since webbrowser may block, and the webserver will block, we must run</span>
    <span class="c1"># them in separate threads.</span>
    <span class="c1">#</span>
    <span class="k">global</span> <span class="n">server_mode</span><span class="p">,</span> <span class="n">logfile</span>
    <span class="n">server_mode</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">runBrowser</span>

    <span class="c1"># Setup logging.</span>
    <span class="k">if</span> <span class="n">logfilename</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">logfilename</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 1 means &#39;line buffering&#39;</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t open </span><span class="si">%s</span><span class="s2"> for writing: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">logfilename</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logfile</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Compute URL and start web browser</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>

    <span class="n">server_ready</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">browser_thread</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">runBrowser</span><span class="p">:</span>
        <span class="n">server_ready</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="n">browser_thread</span> <span class="o">=</span> <span class="n">startBrowser</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">server_ready</span><span class="p">)</span>

    <span class="c1"># Start the server.</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span> <span class="n">MyServerHandler</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">logfile</span><span class="p">:</span>
        <span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;NLTK Wordnet browser server running serving: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">runBrowser</span><span class="p">:</span>
        <span class="n">server_ready</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">if</span> <span class="n">runBrowser</span><span class="p">:</span>
        <span class="n">browser_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">logfile</span><span class="p">:</span>
        <span class="n">logfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">startBrowser</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">server_ready</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
        <span class="n">server_ready</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Wait a little bit more, there&#39;s still the chance of</span>
        <span class="c1"># a race condition.</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">autoraise</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">t</span>


<span class="c1">#####################################################################</span>
<span class="c1"># Utilities</span>
<span class="c1">#####################################################################</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">WordNet Browser Utilities.</span>

<span class="sd">This provides a backend to both wxbrowse and browserver.py.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">################################################################################</span>
<span class="c1">#</span>
<span class="c1"># Main logic for wordnet browser.</span>
<span class="c1">#</span>

<span class="c1"># This is wrapped inside a function since wn is only available if the</span>
<span class="c1"># WordNet corpus is installed.</span>
<span class="k">def</span> <span class="nf">_pos_tuples</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">wn</span><span class="o">.</span><span class="n">NOUN</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;noun&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">wn</span><span class="o">.</span><span class="n">VERB</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;verb&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">wn</span><span class="o">.</span><span class="n">ADJ</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="s2">&quot;adj&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">wn</span><span class="o">.</span><span class="n">ADV</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;adv&quot;</span><span class="p">),</span>
    <span class="p">]</span>


<span class="k">def</span> <span class="nf">_pos_match</span><span class="p">(</span><span class="n">pos_tuple</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns the complete pos tuple for the partial pos</span>
<span class="sd">    tuple given to it.  It attempts to match it against the first</span>
<span class="sd">    non-null component of the given pos tuple.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pos_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
        <span class="n">pos_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">pos_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pos_tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">_pos_tuples</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">pt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="n">pos_tuple</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">pt</span>
    <span class="k">return</span> <span class="kc">None</span>


<span class="n">HYPONYM</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">HYPERNYM</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CLASS_REGIONAL</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">PART_HOLONYM</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">PART_MERONYM</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ATTRIBUTE</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">SUBSTANCE_HOLONYM</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">SUBSTANCE_MERONYM</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">MEMBER_HOLONYM</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">MEMBER_MERONYM</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">VERB_GROUP</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">INSTANCE_HYPONYM</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">INSTANCE_HYPERNYM</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">CAUSE</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">ALSO_SEE</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">SIMILAR</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">ENTAILMENT</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">ANTONYM</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">FRAMES</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">PERTAINYM</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">CLASS_CATEGORY</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">CLASS_USAGE</span> <span class="o">=</span> <span class="mi">22</span>
<span class="n">CLASS_REGIONAL</span> <span class="o">=</span> <span class="mi">23</span>
<span class="n">CLASS_USAGE</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">CLASS_CATEGORY</span> <span class="o">=</span> <span class="mi">11</span>

<span class="n">DERIVATIONALLY_RELATED_FORM</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">INDIRECT_HYPERNYMS</span> <span class="o">=</span> <span class="mi">26</span>


<span class="k">def</span> <span class="nf">lemma_property</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">flattern</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">flattern</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="k">return</span> <span class="n">flattern</span><span class="p">([</span><span class="n">func</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">synset</span><span class="o">.</span><span class="n">lemmas</span><span class="p">()</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">word</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">rebuild_tree</span><span class="p">(</span><span class="n">orig_tree</span><span class="p">):</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">children</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="p">[</span><span class="n">rebuild_tree</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">children</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">get_relations_data</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get synset relations data for a synset.  Note that this doesn&#39;t</span>
<span class="sd">    yet support things such as full hyponym vs direct hyponym.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">synset</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span> <span class="o">==</span> <span class="n">wn</span><span class="o">.</span><span class="n">NOUN</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">HYPONYM</span><span class="p">,</span> <span class="s2">&quot;Hyponyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">hyponyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">INSTANCE_HYPONYM</span><span class="p">,</span> <span class="s2">&quot;Instance hyponyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">instance_hyponyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">HYPERNYM</span><span class="p">,</span> <span class="s2">&quot;Direct hypernyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">hypernyms</span><span class="p">()),</span>
            <span class="p">(</span>
                <span class="n">INDIRECT_HYPERNYMS</span><span class="p">,</span>
                <span class="s2">&quot;Indirect hypernyms&quot;</span><span class="p">,</span>
                <span class="n">rebuild_tree</span><span class="p">(</span><span class="n">synset</span><span class="o">.</span><span class="n">tree</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">hypernyms</span><span class="p">()))[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span>
            <span class="c1">#  hypernyms&#39;, &#39;Sister terms&#39;,</span>
            <span class="p">(</span><span class="n">INSTANCE_HYPERNYM</span><span class="p">,</span> <span class="s2">&quot;Instance hypernyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">instance_hypernyms</span><span class="p">()),</span>
            <span class="c1">#            (CLASS_REGIONAL, [&#39;domain term region&#39;], ),</span>
            <span class="p">(</span><span class="n">PART_HOLONYM</span><span class="p">,</span> <span class="s2">&quot;Part holonyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">part_holonyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">PART_MERONYM</span><span class="p">,</span> <span class="s2">&quot;Part meronyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">part_meronyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">SUBSTANCE_HOLONYM</span><span class="p">,</span> <span class="s2">&quot;Substance holonyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">substance_holonyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">SUBSTANCE_MERONYM</span><span class="p">,</span> <span class="s2">&quot;Substance meronyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">substance_meronyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">MEMBER_HOLONYM</span><span class="p">,</span> <span class="s2">&quot;Member holonyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">member_holonyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">MEMBER_MERONYM</span><span class="p">,</span> <span class="s2">&quot;Member meronyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">member_meronyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">ATTRIBUTE</span><span class="p">,</span> <span class="s2">&quot;Attributes&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">attributes</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">ANTONYM</span><span class="p">,</span> <span class="s2">&quot;Antonyms&quot;</span><span class="p">,</span> <span class="n">lemma_property</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">antonyms</span><span class="p">())),</span>
            <span class="p">(</span>
                <span class="n">DERIVATIONALLY_RELATED_FORM</span><span class="p">,</span>
                <span class="s2">&quot;Derivationally related form&quot;</span><span class="p">,</span>
                <span class="n">lemma_property</span><span class="p">(</span>
                    <span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">derivationally_related_forms</span><span class="p">()</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">synset</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span> <span class="o">==</span> <span class="n">wn</span><span class="o">.</span><span class="n">VERB</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">ANTONYM</span><span class="p">,</span> <span class="s2">&quot;Antonym&quot;</span><span class="p">,</span> <span class="n">lemma_property</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">antonyms</span><span class="p">())),</span>
            <span class="p">(</span><span class="n">HYPONYM</span><span class="p">,</span> <span class="s2">&quot;Hyponym&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">hyponyms</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">HYPERNYM</span><span class="p">,</span> <span class="s2">&quot;Direct hypernyms&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">hypernyms</span><span class="p">()),</span>
            <span class="p">(</span>
                <span class="n">INDIRECT_HYPERNYMS</span><span class="p">,</span>
                <span class="s2">&quot;Indirect hypernyms&quot;</span><span class="p">,</span>
                <span class="n">rebuild_tree</span><span class="p">(</span><span class="n">synset</span><span class="o">.</span><span class="n">tree</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">hypernyms</span><span class="p">()))[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span>
            <span class="p">(</span><span class="n">ENTAILMENT</span><span class="p">,</span> <span class="s2">&quot;Entailments&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">entailments</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">CAUSE</span><span class="p">,</span> <span class="s2">&quot;Causes&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">causes</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">ALSO_SEE</span><span class="p">,</span> <span class="s2">&quot;Also see&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">also_sees</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">VERB_GROUP</span><span class="p">,</span> <span class="s2">&quot;Verb Groups&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">verb_groups</span><span class="p">()),</span>
            <span class="p">(</span>
                <span class="n">DERIVATIONALLY_RELATED_FORM</span><span class="p">,</span>
                <span class="s2">&quot;Derivationally related form&quot;</span><span class="p">,</span>
                <span class="n">lemma_property</span><span class="p">(</span>
                    <span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">derivationally_related_forms</span><span class="p">()</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">synset</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span> <span class="o">==</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADJ</span> <span class="ow">or</span> <span class="n">synset</span><span class="o">.</span><span class="n">pos</span> <span class="o">==</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADJ_SAT</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">ANTONYM</span><span class="p">,</span> <span class="s2">&quot;Antonym&quot;</span><span class="p">,</span> <span class="n">lemma_property</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">antonyms</span><span class="p">())),</span>
            <span class="p">(</span><span class="n">SIMILAR</span><span class="p">,</span> <span class="s2">&quot;Similar to&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">similar_tos</span><span class="p">()),</span>
            <span class="c1"># Participle of verb - not supported by corpus</span>
            <span class="p">(</span>
                <span class="n">PERTAINYM</span><span class="p">,</span>
                <span class="s2">&quot;Pertainyms&quot;</span><span class="p">,</span>
                <span class="n">lemma_property</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">pertainyms</span><span class="p">()),</span>
            <span class="p">),</span>
            <span class="p">(</span><span class="n">ATTRIBUTE</span><span class="p">,</span> <span class="s2">&quot;Attributes&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">attributes</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">ALSO_SEE</span><span class="p">,</span> <span class="s2">&quot;Also see&quot;</span><span class="p">,</span> <span class="n">synset</span><span class="o">.</span><span class="n">also_sees</span><span class="p">()),</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">synset</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span> <span class="o">==</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADV</span><span class="p">:</span>
        <span class="c1"># This is weird. adverbs such as &#39;quick&#39; and &#39;fast&#39; don&#39;t seem</span>
        <span class="c1"># to have antonyms returned by the corpus.a</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">ANTONYM</span><span class="p">,</span> <span class="s2">&quot;Antonym&quot;</span><span class="p">,</span> <span class="n">lemma_property</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">antonyms</span><span class="p">())),</span>
        <span class="p">)</span>
        <span class="c1"># Derived from adjective - not supported by corpus</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unhandles synset POS type: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">synset</span><span class="o">.</span><span class="n">pos</span><span class="p">()))</span>


<span class="n">html_header</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;!DOCTYPE html PUBLIC &#39;-//W3C//DTD HTML 4.01//EN&#39;</span>
<span class="s2">&#39;http://www.w3.org/TR/html4/strict.dtd&#39;&gt;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">&lt;meta name=&#39;generator&#39; content=</span>
<span class="s2">&#39;HTML Tidy for Windows (vers 14 February 2006), see www.w3.org&#39;&gt;</span>
<span class="s2">&lt;meta http-equiv=&#39;Content-Type&#39; content=</span>
<span class="s2">&#39;text/html; charset=us-ascii&#39;&gt;</span>
<span class="s2">&lt;title&gt;NLTK Wordnet Browser display of: </span><span class="si">%s</span><span class="s2">&lt;/title&gt;&lt;/head&gt;</span>
<span class="s2">&lt;body bgcolor=&#39;#F5F5F5&#39; text=&#39;#000000&#39;&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">html_trailer</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">explanation</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;h3&gt;Search Help&lt;/h3&gt;</span>
<span class="s2">&lt;ul&gt;&lt;li&gt;The display below the line is an example of the output the browser</span>
<span class="s2">shows you when you enter a search word. The search word was &lt;b&gt;green&lt;/b&gt;.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;The search result shows for different parts of speech the &lt;b&gt;synsets&lt;/b&gt;</span>
<span class="s2">i.e. different meanings for the word.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;All underlined texts are hypertext links. There are two types of links:</span>
<span class="s2">word links and others. Clicking a word link carries out a search for the word</span>
<span class="s2">in the Wordnet database.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Clicking a link of the other type opens a display section of data attached</span>
<span class="s2">to that link. Clicking that link a second time closes the section again.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Clicking &lt;u&gt;S:&lt;/u&gt; opens a section showing the relations for that synset.</span>
<span class="s2">&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Clicking on a relation name opens a section that displays the associated</span>
<span class="s2">synsets.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Type a search word in the &lt;b&gt;Word&lt;/b&gt; field and start the search by the</span>
<span class="s2">&lt;b&gt;Enter/Return&lt;/b&gt; key or click the &lt;b&gt;Search&lt;/b&gt; button.&lt;/li&gt;</span>
<span class="s2">&lt;/ul&gt;</span>
<span class="s2">&lt;hr width=&#39;100%&#39;&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># HTML oriented functions</span>


<span class="k">def</span> <span class="nf">_bold</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;b&gt;</span><span class="si">%s</span><span class="s2">&lt;/b&gt;&quot;</span> <span class="o">%</span> <span class="n">txt</span>


<span class="k">def</span> <span class="nf">_center</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;center&gt;</span><span class="si">%s</span><span class="s2">&lt;/center&gt;&quot;</span> <span class="o">%</span> <span class="n">txt</span>


<span class="k">def</span> <span class="nf">_hlev</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">txt</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;h</span><span class="si">%d</span><span class="s2">&gt;</span><span class="si">%s</span><span class="s2">&lt;/h</span><span class="si">%d</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_italic</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;i&gt;</span><span class="si">%s</span><span class="s2">&lt;/i&gt;&quot;</span> <span class="o">%</span> <span class="n">txt</span>


<span class="k">def</span> <span class="nf">_li</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;li&gt;</span><span class="si">%s</span><span class="s2">&lt;/li&gt;&quot;</span> <span class="o">%</span> <span class="n">txt</span>


<span class="k">def</span> <span class="nf">pg</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a HTML page of NLTK Browser format constructed from the</span>
<span class="sd">    word and body</span>

<span class="sd">    :param word: The word that the body corresponds to</span>
<span class="sd">    :type word: str</span>
<span class="sd">    :param body: The HTML body corresponding to the word</span>
<span class="sd">    :type body: str</span>
<span class="sd">    :return: a HTML page for the word-body combination</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">html_header</span> <span class="o">%</span> <span class="n">word</span><span class="p">)</span> <span class="o">+</span> <span class="n">body</span> <span class="o">+</span> <span class="n">html_trailer</span>


<span class="k">def</span> <span class="nf">_ul</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;ul&gt;&quot;</span> <span class="o">+</span> <span class="n">txt</span> <span class="o">+</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span>


<span class="k">def</span> <span class="nf">_abbc</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    abbc = asterisks, breaks, bold, center</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_center</span><span class="p">(</span><span class="n">_bold</span><span class="p">(</span><span class="s2">&quot;&lt;br&gt;&quot;</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">txt</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">10</span><span class="p">))</span>


<span class="n">full_hyponym_cont_text</span> <span class="o">=</span> <span class="n">_ul</span><span class="p">(</span><span class="n">_li</span><span class="p">(</span><span class="n">_italic</span><span class="p">(</span><span class="s2">&quot;(has full hyponym continuation)&quot;</span><span class="p">)))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="k">def</span> <span class="nf">_get_synset</span><span class="p">(</span><span class="n">synset_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The synset key is the unique name of the synset, this can be</span>
<span class="sd">    retrieved via synset.name()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wn</span><span class="o">.</span><span class="n">synset</span><span class="p">(</span><span class="n">synset_key</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_collect_one_synset</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="n">synset_relations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the HTML string for one synset or word</span>

<span class="sd">    :param word: the current word</span>
<span class="sd">    :type word: str</span>
<span class="sd">    :param synset: a synset</span>
<span class="sd">    :type synset: synset</span>
<span class="sd">    :param synset_relations: information about which synset relations</span>
<span class="sd">    to display.</span>
<span class="sd">    :type synset_relations: dict(synset_key, set(relation_id))</span>
<span class="sd">    :return: The HTML string built for this synset</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">synset</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c1"># It&#39;s a word</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;word not supported by _collect_one_synset&quot;</span><span class="p">)</span>

    <span class="n">typ</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>
    <span class="n">pos_tuple</span> <span class="o">=</span> <span class="n">_pos_match</span><span class="p">((</span><span class="n">synset</span><span class="o">.</span><span class="n">pos</span><span class="p">(),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="k">assert</span> <span class="n">pos_tuple</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;pos_tuple is null: synset.pos(): </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">synset</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
    <span class="n">descr</span> <span class="o">=</span> <span class="n">pos_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">Reference</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset_relations</span><span class="p">))</span>
    <span class="n">ref</span><span class="o">.</span><span class="n">toggle_synset</span><span class="p">(</span><span class="n">synset</span><span class="p">)</span>
    <span class="n">synset_label</span> <span class="o">=</span> <span class="n">typ</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span>
    <span class="k">if</span> <span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="ow">in</span> <span class="n">synset_relations</span><span class="p">:</span>
        <span class="n">synset_label</span> <span class="o">=</span> <span class="n">_bold</span><span class="p">(</span><span class="n">synset_label</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;li&gt;</span><span class="si">{</span><span class="n">make_lookup_link</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">synset_label</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">descr</span><span class="si">}</span><span class="s2">) &quot;</span>

    <span class="k">def</span> <span class="nf">format_lemma</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_bold</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">Reference</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">make_lookup_link</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">format_lemma</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">())</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">synset</span><span class="o">.</span><span class="n">lemmas</span><span class="p">())</span>

    <span class="n">gl</span> <span class="o">=</span> <span class="s2">&quot; (</span><span class="si">{}</span><span class="s2">) &lt;i&gt;</span><span class="si">{}</span><span class="s2">&lt;/i&gt; &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">synset</span><span class="o">.</span><span class="n">definition</span><span class="p">(),</span>
        <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">synset</span><span class="o">.</span><span class="n">examples</span><span class="p">()),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="n">gl</span> <span class="o">+</span> <span class="n">_synset_relations</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="n">synset_relations</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="k">def</span> <span class="nf">_collect_all_synsets</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">synset_relations</span><span class="o">=</span><span class="nb">dict</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a HTML unordered list of synsets for the given word and</span>
<span class="sd">    part of speech.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;ul&gt;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&lt;/ul&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">_collect_one_synset</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="n">synset_relations</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">synset</span> <span class="ow">in</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_synset_relations</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="n">synset_relations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the HTML string for the relations of a synset</span>

<span class="sd">    :param word: The current word</span>
<span class="sd">    :type word: str</span>
<span class="sd">    :param synset: The synset for which we&#39;re building the relations.</span>
<span class="sd">    :type synset: Synset</span>
<span class="sd">    :param synset_relations: synset keys and relation types for which to display relations.</span>
<span class="sd">    :type synset_relations: dict(synset_key, set(relation_type))</span>
<span class="sd">    :return: The HTML for a synset&#39;s relations</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="ow">in</span> <span class="n">synset_relations</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">Reference</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset_relations</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">relation_html</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Synset</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">make_lookup_link</span><span class="p">(</span><span class="n">Reference</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">lemma_names</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">r</span><span class="o">.</span><span class="n">lemma_names</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Lemma</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">relation_html</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">synset</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="c1"># It&#39;s probably a tuple containing a Synset and a list of</span>
            <span class="c1"># similar tuples.  This forms a tree of synsets.</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&lt;ul&gt;</span><span class="si">{}</span><span class="s2">&lt;/ul&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">relation_html</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;&lt;li&gt;</span><span class="si">%s</span><span class="s2">&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">relation_html</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span> <span class="k">for</span> <span class="n">sr</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;r must be a synset, lemma or list, it was: type(r) = </span><span class="si">%s</span><span class="s2">, r = </span><span class="si">%s</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">make_synset_html</span><span class="p">(</span><span class="n">db_name</span><span class="p">,</span> <span class="n">disp_name</span><span class="p">,</span> <span class="n">rels</span><span class="p">):</span>
        <span class="n">synset_html</span> <span class="o">=</span> <span class="s2">&quot;&lt;i&gt;</span><span class="si">%s</span><span class="s2">&lt;/i&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">make_lookup_link</span><span class="p">(</span>
            <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="o">.</span><span class="n">toggle_synset_relation</span><span class="p">(</span><span class="n">synset</span><span class="p">,</span> <span class="n">db_name</span><span class="p">),</span>
            <span class="n">disp_name</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">db_name</span> <span class="ow">in</span> <span class="n">ref</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">[</span><span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()]:</span>
            <span class="n">synset_html</span> <span class="o">+=</span> <span class="s2">&quot;&lt;ul&gt;</span><span class="si">%s</span><span class="s2">&lt;/ul&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="s2">&quot;&lt;li&gt;</span><span class="si">%s</span><span class="s2">&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">relation_html</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rels</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">synset_html</span>

    <span class="n">html</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;&lt;ul&gt;&quot;</span>
        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="s2">&quot;&lt;li&gt;</span><span class="si">%s</span><span class="s2">&lt;/li&gt;&quot;</span> <span class="o">%</span> <span class="n">make_synset_html</span><span class="p">(</span><span class="o">*</span><span class="n">rel_data</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rel_data</span> <span class="ow">in</span> <span class="n">get_relations_data</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rel_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">html</span>


<span class="k">class</span> <span class="nc">RestrictedUnpickler</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">Unpickler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unpickler that prevents any class or function from being used during loading.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">find_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># Forbid every function</span>
        <span class="k">raise</span> <span class="n">pickle</span><span class="o">.</span><span class="n">UnpicklingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;global &#39;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is forbidden&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Reference</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A reference to a page that may be generated by page_word</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">synset_relations</span><span class="o">=</span><span class="nb">dict</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a reference to a new page.</span>

<span class="sd">        word is the word or words (separated by commas) for which to</span>
<span class="sd">        search for synsets of</span>

<span class="sd">        synset_relations is a dictionary of synset keys to sets of</span>
<span class="sd">        synset relation identifaiers to unfold a list of synset</span>
<span class="sd">        relations for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">word</span> <span class="o">=</span> <span class="n">word</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span> <span class="o">=</span> <span class="n">synset_relations</span>

    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Encode this reference into a string to be used in a URL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This uses a tuple rather than an object since the python</span>
        <span class="c1"># pickle representation is much smaller and there is no need</span>
        <span class="c1"># to represent the complete object.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">word</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decode a reference encoded with Reference.encode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64decode</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">word</span><span class="p">,</span> <span class="n">synset_relations</span> <span class="o">=</span> <span class="n">RestrictedUnpickler</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">string</span><span class="p">))</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Reference</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">synset_relations</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">toggle_synset_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synset</span><span class="p">,</span> <span class="n">relation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle the display of the relations for the given synset and</span>
<span class="sd">        relation type.</span>

<span class="sd">        This function will throw a KeyError if the synset is currently</span>
<span class="sd">        not being displayed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">relation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">[</span><span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">[</span><span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">relation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">[</span><span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">relation</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">toggle_synset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle displaying of the relation types for the given synset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">[</span><span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">[</span><span class="n">synset</span><span class="o">.</span><span class="n">name</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span>


<span class="k">def</span> <span class="nf">make_lookup_link</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&lt;a href=&quot;lookup_</span><span class="si">{</span><span class="n">ref</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;&gt;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&lt;/a&gt;&#39;</span>


<span class="k">def</span> <span class="nf">page_from_word</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a HTML page for the given word.</span>

<span class="sd">    :type word: str</span>
<span class="sd">    :param word: The currently active word</span>
<span class="sd">    :return: A tuple (page,word), where page is the new current HTML page</span>
<span class="sd">        to be sent to the browser and</span>
<span class="sd">        word is the new current word</span>
<span class="sd">    :rtype: A tuple (str,str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">page_from_reference</span><span class="p">(</span><span class="n">Reference</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">page_from_href</span><span class="p">(</span><span class="n">href</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of the HTML page built and the new current word</span>

<span class="sd">    :param href: The hypertext reference to be solved</span>
<span class="sd">    :type href: str</span>
<span class="sd">    :return: A tuple (page,word), where page is the new current HTML page</span>
<span class="sd">             to be sent to the browser and</span>
<span class="sd">             word is the new current word</span>
<span class="sd">    :rtype: A tuple (str,str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">page_from_reference</span><span class="p">(</span><span class="n">Reference</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">href</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">page_from_reference</span><span class="p">(</span><span class="n">href</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of the HTML page built and the new current word</span>

<span class="sd">    :param href: The hypertext reference to be solved</span>
<span class="sd">    :type href: str</span>
<span class="sd">    :return: A tuple (page,word), where page is the new current HTML page</span>
<span class="sd">             to be sent to the browser and</span>
<span class="sd">             word is the new current word</span>
<span class="sd">    :rtype: A tuple (str,str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">href</span><span class="o">.</span><span class="n">word</span>
    <span class="n">pos_forms</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span> <span class="k">if</span> <span class="n">w</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># No words were found.</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Please specify a word to search for.&quot;</span>

    <span class="c1"># This looks up multiple words at once.  This is probably not</span>
    <span class="c1"># necessary and may lead to problems.</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="p">[</span><span class="n">wn</span><span class="o">.</span><span class="n">NOUN</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">VERB</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADJ</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADV</span><span class="p">]:</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">morphy</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">form</span> <span class="ow">and</span> <span class="n">form</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pos_forms</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
                <span class="n">pos_forms</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">pos_str</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">_pos_tuples</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos_forms</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="n">_hlev</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">pos_forms</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
                <span class="c1"># Not all words of exc files are in the database, skip</span>
                <span class="c1"># to the next word if a KeyError is raised.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">body</span> <span class="o">+=</span> <span class="n">_collect_all_synsets</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">href</span><span class="o">.</span><span class="n">synset_relations</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">body</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;The word or words &#39;</span><span class="si">%s</span><span class="s2">&#39; were not found in the dictionary.&quot;</span> <span class="o">%</span> <span class="n">word</span>
    <span class="k">return</span> <span class="n">body</span><span class="p">,</span> <span class="n">word</span>


<span class="c1">#####################################################################</span>
<span class="c1"># Static pages</span>
<span class="c1">#####################################################################</span>


<span class="k">def</span> <span class="nf">get_static_page_by_path</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a static HTML page from the path given.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;index_2.html&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_static_index_page</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;index.html&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_static_index_page</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;NLTK Wordnet Browser Database Info.html&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Display of Wordnet Database Statistics is not supported&quot;</span>
    <span class="k">elif</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;upper_2.html&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_static_upper_page</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;upper.html&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_static_upper_page</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;web_help.html&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_static_web_help_page</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;wx_help.html&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_static_wx_help_page</span><span class="p">()</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_static_web_help_page</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the static web help page.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">     &lt;!-- Natural Language Toolkit: Wordnet Interface: Graphical Wordnet Browser</span>
<span class="s2">            Copyright (C) 2001-2023 NLTK Project</span>
<span class="s2">            Author: Jussi Salmela &lt;jtsalmela@users.sourceforge.net&gt;</span>
<span class="s2">            URL: &lt;https://www.nltk.org/&gt;</span>
<span class="s2">            For license information, see LICENSE.TXT --&gt;</span>
<span class="s2">     &lt;head&gt;</span>
<span class="s2">          &lt;meta http-equiv=&#39;Content-Type&#39; content=&#39;text/html; charset=us-ascii&#39;&gt;</span>
<span class="s2">          &lt;title&gt;NLTK Wordnet Browser display of: * Help *&lt;/title&gt;</span>
<span class="s2">     &lt;/head&gt;</span>
<span class="s2">&lt;body bgcolor=&#39;#F5F5F5&#39; text=&#39;#000000&#39;&gt;</span>
<span class="s2">&lt;h2&gt;NLTK Wordnet Browser Help&lt;/h2&gt;</span>
<span class="s2">&lt;p&gt;The NLTK Wordnet Browser is a tool to use in browsing the Wordnet database. It tries to behave like the Wordnet project&#39;s web browser but the difference is that the NLTK Wordnet Browser uses a local Wordnet database.</span>
<span class="s2">&lt;p&gt;&lt;b&gt;You are using the Javascript client part of the NLTK Wordnet BrowseServer.&lt;/b&gt; We assume your browser is in tab sheets enabled mode.&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;For background information on Wordnet, see the Wordnet project home page: &lt;a href=&quot;https://wordnet.princeton.edu/&quot;&gt;&lt;b&gt; https://wordnet.princeton.edu/&lt;/b&gt;&lt;/a&gt;. For more information on the NLTK project, see the project home:</span>
<span class="s2">&lt;a href=&quot;https://www.nltk.org/&quot;&gt;&lt;b&gt;https://www.nltk.org/&lt;/b&gt;&lt;/a&gt;. To get an idea of what the Wordnet version used by this browser includes choose &lt;b&gt;Show Database Info&lt;/b&gt; from the &lt;b&gt;View&lt;/b&gt; submenu.&lt;/p&gt;</span>
<span class="s2">&lt;h3&gt;Word search&lt;/h3&gt;</span>
<span class="s2">&lt;p&gt;The word to be searched is typed into the &lt;b&gt;New Word&lt;/b&gt; field and the search started with Enter or by clicking the &lt;b&gt;Search&lt;/b&gt; button. There is no uppercase/lowercase distinction: the search word is transformed to lowercase before the search.&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;In addition, the word does not have to be in base form. The browser tries to find the possible base form(s) by making certain morphological substitutions. Typing &lt;b&gt;fLIeS&lt;/b&gt; as an obscure example gives one &lt;a href=&quot;MfLIeS&quot;&gt;this&lt;/a&gt;. Click the previous link to see what this kind of search looks like and then come back to this page by using the &lt;b&gt;Alt+LeftArrow&lt;/b&gt; key combination.&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;The result of a search is a display of one or more</span>
<span class="s2">&lt;b&gt;synsets&lt;/b&gt; for every part of speech in which a form of the</span>
<span class="s2">search word was found to occur. A synset is a set of words</span>
<span class="s2">having the same sense or meaning. Each word in a synset that is</span>
<span class="s2">underlined is a hyperlink which can be clicked to trigger an</span>
<span class="s2">automatic search for that word.&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;Every synset has a hyperlink &lt;b&gt;S:&lt;/b&gt; at the start of its</span>
<span class="s2">display line. Clicking that symbol shows you the name of every</span>
<span class="s2">&lt;b&gt;relation&lt;/b&gt; that this synset is part of. Every relation name is a hyperlink that opens up a display for that relation. Clicking it another time closes the display again. Clicking another relation name on a line that has an opened relation closes the open relation and opens the clicked relation.&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;It is also possible to give two or more words or collocations to be searched at the same time separating them with a comma like this &lt;a href=&quot;Mcheer up,clear up&quot;&gt;cheer up,clear up&lt;/a&gt;, for example. Click the previous link to see what this kind of search looks like and then come back to this page by using the &lt;b&gt;Alt+LeftArrow&lt;/b&gt; key combination. As you could see the search result includes the synsets found in the same order than the forms were given in the search field.&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;</span>
<span class="s2">There are also word level (lexical) relations recorded in the Wordnet database. Opening this kind of relation displays lines with a hyperlink &lt;b&gt;W:&lt;/b&gt; at their beginning. Clicking this link shows more info on the word in question.&lt;/p&gt;</span>
<span class="s2">&lt;h3&gt;The Buttons&lt;/h3&gt;</span>
<span class="s2">&lt;p&gt;The &lt;b&gt;Search&lt;/b&gt; and &lt;b&gt;Help&lt;/b&gt; buttons need no more explanation. &lt;/p&gt;</span>
<span class="s2">&lt;p&gt;The &lt;b&gt;Show Database Info&lt;/b&gt; button shows a collection of Wordnet database statistics.&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;The &lt;b&gt;Shutdown the Server&lt;/b&gt; button is shown for the first client of the BrowServer program i.e. for the client that is automatically launched when the BrowServer is started but not for the succeeding clients in order to protect the server from accidental shutdowns.</span>
<span class="s2">&lt;/p&gt;&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">get_static_welcome_message</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the static welcome page.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;h3&gt;Search Help&lt;/h3&gt;</span>
<span class="s2">&lt;ul&gt;&lt;li&gt;The display below the line is an example of the output the browser</span>
<span class="s2">shows you when you enter a search word. The search word was &lt;b&gt;green&lt;/b&gt;.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;The search result shows for different parts of speech the &lt;b&gt;synsets&lt;/b&gt;</span>
<span class="s2">i.e. different meanings for the word.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;All underlined texts are hypertext links. There are two types of links:</span>
<span class="s2">word links and others. Clicking a word link carries out a search for the word</span>
<span class="s2">in the Wordnet database.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Clicking a link of the other type opens a display section of data attached</span>
<span class="s2">to that link. Clicking that link a second time closes the section again.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Clicking &lt;u&gt;S:&lt;/u&gt; opens a section showing the relations for that synset.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Clicking on a relation name opens a section that displays the associated</span>
<span class="s2">synsets.&lt;/li&gt;</span>
<span class="s2">&lt;li&gt;Type a search word in the &lt;b&gt;Next Word&lt;/b&gt; field and start the search by the</span>
<span class="s2">&lt;b&gt;Enter/Return&lt;/b&gt; key or click the &lt;b&gt;Search&lt;/b&gt; button.&lt;/li&gt;</span>
<span class="s2">&lt;/ul&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">get_static_index_page</span><span class="p">(</span><span class="n">with_shutdown</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the static index page.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;  &quot;http://www.w3.org/TR/html4/frameset.dtd&quot;&gt;</span>
<span class="s2">&lt;HTML&gt;</span>
<span class="s2">     &lt;!-- Natural Language Toolkit: Wordnet Interface: Graphical Wordnet Browser</span>
<span class="s2">            Copyright (C) 2001-2023 NLTK Project</span>
<span class="s2">            Author: Jussi Salmela &lt;jtsalmela@users.sourceforge.net&gt;</span>
<span class="s2">            URL: &lt;https://www.nltk.org/&gt;</span>
<span class="s2">            For license information, see LICENSE.TXT --&gt;</span>
<span class="s2">     &lt;HEAD&gt;</span>
<span class="s2">         &lt;TITLE&gt;NLTK Wordnet Browser&lt;/TITLE&gt;</span>
<span class="s2">     &lt;/HEAD&gt;</span>

<span class="s2">&lt;frameset rows=&quot;7</span><span class="si">%%</span><span class="s2">,93</span><span class="si">%%</span><span class="s2">&quot;&gt;</span>
<span class="s2">    &lt;frame src=&quot;</span><span class="si">%s</span><span class="s2">&quot; name=&quot;header&quot;&gt;</span>
<span class="s2">    &lt;frame src=&quot;start_page&quot; name=&quot;body&quot;&gt;</span>
<span class="s2">&lt;/frameset&gt;</span>
<span class="s2">&lt;/HTML&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">with_shutdown</span><span class="p">:</span>
        <span class="n">upper_link</span> <span class="o">=</span> <span class="s2">&quot;upper.html&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">upper_link</span> <span class="o">=</span> <span class="s2">&quot;upper_2.html&quot;</span>

    <span class="k">return</span> <span class="n">template</span> <span class="o">%</span> <span class="n">upper_link</span>


<span class="k">def</span> <span class="nf">get_static_upper_page</span><span class="p">(</span><span class="n">with_shutdown</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the upper frame page,</span>

<span class="sd">    If with_shutdown is True then a &#39;shutdown&#39; button is also provided</span>
<span class="sd">    to shutdown the server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">    &lt;!-- Natural Language Toolkit: Wordnet Interface: Graphical Wordnet Browser</span>
<span class="s2">        Copyright (C) 2001-2023 NLTK Project</span>
<span class="s2">        Author: Jussi Salmela &lt;jtsalmela@users.sourceforge.net&gt;</span>
<span class="s2">        URL: &lt;https://www.nltk.org/&gt;</span>
<span class="s2">        For license information, see LICENSE.TXT --&gt;</span>
<span class="s2">    &lt;head&gt;</span>
<span class="s2">                &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot; /&gt;</span>
<span class="s2">        &lt;title&gt;Untitled Document&lt;/title&gt;</span>
<span class="s2">    &lt;/head&gt;</span>
<span class="s2">    &lt;body&gt;</span>
<span class="s2">    &lt;form method=&quot;GET&quot; action=&quot;search&quot; target=&quot;body&quot;&gt;</span>
<span class="s2">            Current Word:&amp;nbsp;&lt;input type=&quot;text&quot; id=&quot;currentWord&quot; size=&quot;10&quot; disabled&gt;</span>
<span class="s2">            Next Word:&amp;nbsp;&lt;input type=&quot;text&quot; id=&quot;nextWord&quot; name=&quot;nextWord&quot; size=&quot;10&quot;&gt;</span>
<span class="s2">            &lt;input name=&quot;searchButton&quot; type=&quot;submit&quot; value=&quot;Search&quot;&gt;</span>
<span class="s2">    &lt;/form&gt;</span>
<span class="s2">        &lt;a target=&quot;body&quot; href=&quot;web_help.html&quot;&gt;Help&lt;/a&gt;</span>
<span class="s2">        </span><span class="si">%s</span><span class="s2"></span>

<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">with_shutdown</span><span class="p">:</span>
        <span class="n">shutdown_link</span> <span class="o">=</span> <span class="s1">&#39;&lt;a href=&quot;SHUTDOWN THE SERVER&quot;&gt;Shutdown&lt;/a&gt;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shutdown_link</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">return</span> <span class="n">template</span> <span class="o">%</span> <span class="n">shutdown_link</span>


<span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display the command line help message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>


<div class="viewcode-block" id="app"><a class="viewcode-back" href="../../../api/nltk.app.wordnet_app.html#nltk.app.wordnet_app.app">[docs]</a><span class="k">def</span> <span class="nf">app</span><span class="p">():</span>
    <span class="c1"># Parse and interpret options.</span>
    <span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">getopt</span><span class="o">.</span><span class="n">getopt</span><span class="p">(</span>
        <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s2">&quot;l:p:sh&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;logfile=&quot;</span><span class="p">,</span> <span class="s2">&quot;port=&quot;</span><span class="p">,</span> <span class="s2">&quot;server-mode&quot;</span><span class="p">,</span> <span class="s2">&quot;help&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">port</span> <span class="o">=</span> <span class="mi">8000</span>
    <span class="n">server_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">help_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">logfilename</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;-l&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;--logfile&quot;</span><span class="p">):</span>
            <span class="n">logfilename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;-p&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;--port&quot;</span><span class="p">):</span>
            <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;-s&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;--server-mode&quot;</span><span class="p">):</span>
            <span class="n">server_mode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;-h&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;--help&quot;</span><span class="p">):</span>
            <span class="n">help_mode</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">help_mode</span><span class="p">:</span>
        <span class="n">usage</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wnb</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="ow">not</span> <span class="n">server_mode</span><span class="p">,</span> <span class="n">logfilename</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="p">()</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span>
</pre></div>

        </div>
      </div>

    </div>

<footer>
    <div id="footer-info">
        <ul id="build-details">
            

            
                <li class="footer-element">
                    <a href="https://github.com/nltk/nltk/tree/3.8.1">3.8.1</a>
                </li>
            

            
                <li class="footer-element">
                    Jan 02, 2023
                </li>
            
        </ul>

        
            <div id="copyright">
                &copy; 2023, NLTK Project
            </div>
        

        <div id="credit">
            created with <a href="http://sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/tomaarsen/nltk_theme">NLTK Theme</a>
        </div>
    </div>
</footer> 

</div>

</body>
</html>
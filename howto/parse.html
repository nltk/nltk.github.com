<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2D2D2D" />
  
  <title>NLTK :: Sample usage for parse</title>
  

  <link rel="stylesheet" href="../_static/css/nltk_theme.css"/>
  <link rel="stylesheet" href="../_static/css/custom.css"/>

  <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
  

  <script src="https://email.tl.fortawesome.com/c/eJxNjUEOgyAQAF8jR7Kw6wIHDh7sP1Cw2mgxgmn6-3JsMqc5zEQfE8dkxOY1KKMUOI3ACFKRJpSW2AAp7ontYIaxI6i7XPJVwyeVfCQ550Os3jLrGSNOLgbdAy6s0PBk2TFNjEbsfq31LB0OnX407pJa5v2faRadwSW63mn5KuLyR9j2tgx3zecanl-55R_-jjPs"></script> 
</head>

<body>
  <div id="nltk-theme-container">
    <header>
      <div id="logo-container">
          
          <h1>
            <a href="../index.html">NLTK</a>
          </h1>
          
      </div>
      <div id="project-container">
        
        <h1>Documentation</h1>
        
      </div>

      <a id="menu-toggle" class="fa fa-bars" aria-hidden="true"></a>

      <script type="text/javascript">
        $("#menu-toggle").click(function() {
          $("#menu-toggle").toggleClass("toggled");
          $("#side-menu-container").slideToggle(300);
        });
      </script>
    </header>

    <div id="content-container">

      <div id="side-menu-container">

        <div id="search" role="search">
        <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
            <input type="text" name="q" placeholder="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
</div>

        <div id="side-menu" role="navigation">
          
  
    
  
  
    <p class="caption" role="heading"><span class="caption-text">NLTK Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api/nltk.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../howto.html">Example Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../py-modindex.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/wiki">Wiki</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/wiki/FAQ">FAQ</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk/issues">Open Issues</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/nltk/nltk">NLTK on GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing NLTK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Installing NLTK Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing to NLTK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../team.html">NLTK Team</a></li>
</ul>

  

        </div>

        
      </div>

      <div id="main-content-container">
        <div id="main-content" role="main">
          
  <section id="sample-usage-for-parse">
<h1>Sample usage for parse<a class="headerlink" href="#sample-usage-for-parse" title="Permalink to this heading">¶</a></h1>
<section id="parsing">
<h2>Parsing<a class="headerlink" href="#parsing" title="Permalink to this heading">¶</a></h2>
<section id="unit-tests-for-the-context-free-grammar-class">
<h3>Unit tests for the Context Free Grammar class<a class="headerlink" href="#unit-tests-for-the-context-free-grammar-class" title="Permalink to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">Nonterminal</span><span class="p">,</span> <span class="n">nonterminals</span><span class="p">,</span> <span class="n">Production</span><span class="p">,</span> <span class="n">CFG</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nt1</span> <span class="o">=</span> <span class="n">Nonterminal</span><span class="p">(</span><span class="s1">&#39;NP&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nt2</span> <span class="o">=</span> <span class="n">Nonterminal</span><span class="p">(</span><span class="s1">&#39;VP&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nt1</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span>
<span class="go">&#39;NP&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nt1</span> <span class="o">==</span> <span class="n">Nonterminal</span><span class="p">(</span><span class="s1">&#39;NP&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nt1</span> <span class="o">==</span> <span class="n">nt2</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="p">,</span> <span class="n">NP</span><span class="p">,</span> <span class="n">VP</span><span class="p">,</span> <span class="n">PP</span> <span class="o">=</span> <span class="n">nonterminals</span><span class="p">(</span><span class="s1">&#39;S, NP, VP, PP&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">DT</span> <span class="o">=</span> <span class="n">nonterminals</span><span class="p">(</span><span class="s1">&#39;N, V, P, DT&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prod1</span> <span class="o">=</span> <span class="n">Production</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="n">NP</span><span class="p">,</span> <span class="n">VP</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prod2</span> <span class="o">=</span> <span class="n">Production</span><span class="p">(</span><span class="n">NP</span><span class="p">,</span> <span class="p">[</span><span class="n">DT</span><span class="p">,</span> <span class="n">NP</span><span class="p">])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prod1</span><span class="o">.</span><span class="n">lhs</span><span class="p">()</span>
<span class="go">S</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prod1</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="go">(NP, VP)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prod1</span> <span class="o">==</span> <span class="n">Production</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="n">NP</span><span class="p">,</span> <span class="n">VP</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prod1</span> <span class="o">==</span> <span class="n">prod2</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">CFG</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">S -&gt; NP VP</span>
<span class="gp">... </span><span class="s2">PP -&gt; P NP</span>
<span class="gp">... </span><span class="s2">NP -&gt; &#39;the&#39; N | N PP | &#39;the&#39; N PP</span>
<span class="gp">... </span><span class="s2">VP -&gt; V NP | V PP | V NP PP</span>
<span class="gp">... </span><span class="s2">N -&gt; &#39;cat&#39;</span>
<span class="gp">... </span><span class="s2">N -&gt; &#39;dog&#39;</span>
<span class="gp">... </span><span class="s2">N -&gt; &#39;rug&#39;</span>
<span class="gp">... </span><span class="s2">V -&gt; &#39;chased&#39;</span>
<span class="gp">... </span><span class="s2">V -&gt; &#39;sat&#39;</span>
<span class="gp">... </span><span class="s2">P -&gt; &#39;in&#39;</span>
<span class="gp">... </span><span class="s2">P -&gt; &#39;on&#39;</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;import pickle</span>
<span class="gp">... </span><span class="s2">from nltk import Production</span>
<span class="gp">... </span><span class="s2">p = Production(&#39;S&#39;, [&#39;NP&#39;, &#39;VP&#39;])</span>
<span class="gp">... </span><span class="s2">print(pickle.dumps(p))</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Start a subprocess to simulate pickling in another process</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="n">cmd</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">Production</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NP&#39;</span><span class="p">,</span> <span class="s1">&#39;VP&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-rd-recursive-descent-parser-class">
<h3>Unit tests for the rd (Recursive Descent Parser) class<a class="headerlink" href="#unit-tests-for-the-rd-recursive-descent-parser-class" title="Permalink to this heading">¶</a></h3>
<p>Create and run a recursive descent parser over both a syntactically ambiguous
and unambiguous sentence.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk.parse</span> <span class="kn">import</span> <span class="n">RecursiveDescentParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rd</span> <span class="o">=</span> <span class="n">RecursiveDescentParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sentence1</span> <span class="o">=</span> <span class="s1">&#39;the cat chased the dog&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sentence2</span> <span class="o">=</span> <span class="s1">&#39;the cat chased the dog on the rug&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">rd</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sentence1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S (NP the (N cat)) (VP (V chased) (NP the (N dog))))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">rd</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sentence2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S</span>
<span class="go">  (NP the (N cat))</span>
<span class="go">  (VP (V chased) (NP the (N dog) (PP (P on) (NP the (N rug))))))</span>
<span class="go">(S</span>
<span class="go">  (NP the (N cat))</span>
<span class="go">  (VP (V chased) (NP the (N dog)) (PP (P on) (NP the (N rug)))))</span>
</pre></div>
</div>
<dl>
<dt>(dolist (expr doctest-font-lock-keywords)</dt><dd><p>(add-to-list ‘font-lock-keywords expr))</p>
<p>font-lock-keywords</p>
</dd>
<dt>(add-to-list ‘font-lock-keywords</dt><dd><p>(car doctest-font-lock-keywords))</p>
</dd>
</dl>
</section>
<section id="unit-tests-for-the-sr-shift-reduce-parser-class">
<h3>Unit tests for the sr (Shift Reduce Parser) class<a class="headerlink" href="#unit-tests-for-the-sr-shift-reduce-parser-class" title="Permalink to this heading">¶</a></h3>
<p>Create and run a shift reduce parser over both a syntactically ambiguous
and unambiguous sentence. Note that unlike the recursive descent parser, one
and only one parse is ever returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk.parse</span> <span class="kn">import</span> <span class="n">ShiftReduceParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span> <span class="o">=</span> <span class="n">ShiftReduceParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sentence1</span> <span class="o">=</span> <span class="s1">&#39;the cat chased the dog&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sentence2</span> <span class="o">=</span> <span class="s1">&#39;the cat chased the dog on the rug&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sr</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sentence1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S (NP the (N cat)) (VP (V chased) (NP the (N dog))))</span>
</pre></div>
</div>
<p>The shift reduce parser uses heuristics to decide what to do when there are
multiple possible shift or reduce operations available - for the supplied
grammar clearly the wrong operation is selected.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sr</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sentence2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-chart-parser-class">
<h3>Unit tests for the Chart Parser class<a class="headerlink" href="#unit-tests-for-the-chart-parser-class" title="Permalink to this heading">¶</a></h3>
<p>We use the demo() function for testing.
We must turn off showing of times.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
<p>First we test tracing with a short sentence</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">chart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw a dog&#39;</span><span class="p">,</span> <span class="n">numparses</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">* Sentence:</span>
<span class="go">I saw a dog</span>
<span class="go">[&#39;I&#39;, &#39;saw&#39;, &#39;a&#39;, &#39;dog&#39;]</span>

<span class="go">* Strategy: Bottom-up</span>

<span class="go">|.    I    .   saw   .    a    .   dog   .|</span>
<span class="go">|[---------]         .         .         .| [0:1] &#39;I&#39;</span>
<span class="go">|.         [---------]         .         .| [1:2] &#39;saw&#39;</span>
<span class="go">|.         .         [---------]         .| [2:3] &#39;a&#39;</span>
<span class="go">|.         .         .         [---------]| [3:4] &#39;dog&#39;</span>
<span class="go">|&gt;         .         .         .         .| [0:0] NP -&gt; * &#39;I&#39;</span>
<span class="go">|[---------]         .         .         .| [0:1] NP -&gt; &#39;I&#39; *</span>
<span class="go">|&gt;         .         .         .         .| [0:0] S  -&gt; * NP VP</span>
<span class="go">|&gt;         .         .         .         .| [0:0] NP -&gt; * NP PP</span>
<span class="go">|[---------&gt;         .         .         .| [0:1] S  -&gt; NP * VP</span>
<span class="go">|[---------&gt;         .         .         .| [0:1] NP -&gt; NP * PP</span>
<span class="go">|.         &gt;         .         .         .| [1:1] Verb -&gt; * &#39;saw&#39;</span>
<span class="go">|.         [---------]         .         .| [1:2] Verb -&gt; &#39;saw&#39; *</span>
<span class="go">|.         &gt;         .         .         .| [1:1] VP -&gt; * Verb NP</span>
<span class="go">|.         &gt;         .         .         .| [1:1] VP -&gt; * Verb</span>
<span class="go">|.         [---------&gt;         .         .| [1:2] VP -&gt; Verb * NP</span>
<span class="go">|.         [---------]         .         .| [1:2] VP -&gt; Verb *</span>
<span class="go">|.         &gt;         .         .         .| [1:1] VP -&gt; * VP PP</span>
<span class="go">|[-------------------]         .         .| [0:2] S  -&gt; NP VP *</span>
<span class="go">|.         [---------&gt;         .         .| [1:2] VP -&gt; VP * PP</span>
<span class="go">|.         .         &gt;         .         .| [2:2] Det -&gt; * &#39;a&#39;</span>
<span class="go">|.         .         [---------]         .| [2:3] Det -&gt; &#39;a&#39; *</span>
<span class="go">|.         .         &gt;         .         .| [2:2] NP -&gt; * Det Noun</span>
<span class="go">|.         .         [---------&gt;         .| [2:3] NP -&gt; Det * Noun</span>
<span class="go">|.         .         .         &gt;         .| [3:3] Noun -&gt; * &#39;dog&#39;</span>
<span class="go">|.         .         .         [---------]| [3:4] Noun -&gt; &#39;dog&#39; *</span>
<span class="go">|.         .         [-------------------]| [2:4] NP -&gt; Det Noun *</span>
<span class="go">|.         .         &gt;         .         .| [2:2] S  -&gt; * NP VP</span>
<span class="go">|.         .         &gt;         .         .| [2:2] NP -&gt; * NP PP</span>
<span class="go">|.         [-----------------------------]| [1:4] VP -&gt; Verb NP *</span>
<span class="go">|.         .         [-------------------&gt;| [2:4] S  -&gt; NP * VP</span>
<span class="go">|.         .         [-------------------&gt;| [2:4] NP -&gt; NP * PP</span>
<span class="go">|[=======================================]| [0:4] S  -&gt; NP VP *</span>
<span class="go">|.         [-----------------------------&gt;| [1:4] VP -&gt; VP * PP</span>
<span class="go">Nr edges in chart: 33</span>
<span class="go">(S (NP I) (VP (Verb saw) (NP (Det a) (Noun dog))))</span>
</pre></div>
</div>
<p>Then we test the different parsing Strategies.
Note that the number of edges differ between the strategies.</p>
<p>Top-down</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">chart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw John with a dog&#39;</span><span class="p">,</span> <span class="n">numparses</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">* Sentence:</span>
<span class="go">I saw John with a dog</span>
<span class="go">[&#39;I&#39;, &#39;saw&#39;, &#39;John&#39;, &#39;with&#39;, &#39;a&#39;, &#39;dog&#39;]</span>

<span class="go">* Strategy: Top-down</span>

<span class="go">Nr edges in chart: 48</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
</pre></div>
</div>
<p>Bottom-up</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">chart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw John with a dog&#39;</span><span class="p">,</span> <span class="n">numparses</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">* Sentence:</span>
<span class="go">I saw John with a dog</span>
<span class="go">[&#39;I&#39;, &#39;saw&#39;, &#39;John&#39;, &#39;with&#39;, &#39;a&#39;, &#39;dog&#39;]</span>

<span class="go">* Strategy: Bottom-up</span>

<span class="go">Nr edges in chart: 53</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
</pre></div>
</div>
<p>Bottom-up Left-Corner</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">chart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw John with a dog&#39;</span><span class="p">,</span> <span class="n">numparses</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">* Sentence:</span>
<span class="go">I saw John with a dog</span>
<span class="go">[&#39;I&#39;, &#39;saw&#39;, &#39;John&#39;, &#39;with&#39;, &#39;a&#39;, &#39;dog&#39;]</span>

<span class="go">* Strategy: Bottom-up left-corner</span>

<span class="go">Nr edges in chart: 36</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
</pre></div>
</div>
<p>Left-Corner with Bottom-Up Filter</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">chart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw John with a dog&#39;</span><span class="p">,</span> <span class="n">numparses</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">* Sentence:</span>
<span class="go">I saw John with a dog</span>
<span class="go">[&#39;I&#39;, &#39;saw&#39;, &#39;John&#39;, &#39;with&#39;, &#39;a&#39;, &#39;dog&#39;]</span>

<span class="go">* Strategy: Filtered left-corner</span>

<span class="go">Nr edges in chart: 28</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
</pre></div>
</div>
<p>The stepping chart parser</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">chart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw John with a dog&#39;</span><span class="p">,</span> <span class="n">numparses</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">* Sentence:</span>
<span class="go">I saw John with a dog</span>
<span class="go">[&#39;I&#39;, &#39;saw&#39;, &#39;John&#39;, &#39;with&#39;, &#39;a&#39;, &#39;dog&#39;]</span>

<span class="go">* Strategy: Stepping (top-down vs bottom-up)</span>

<span class="go">*** SWITCH TO TOP DOWN</span>
<span class="go">|[------]      .      .      .      .      .| [0:1] &#39;I&#39;</span>
<span class="go">|.      [------]      .      .      .      .| [1:2] &#39;saw&#39;</span>
<span class="go">|.      .      [------]      .      .      .| [2:3] &#39;John&#39;</span>
<span class="go">|.      .      .      [------]      .      .| [3:4] &#39;with&#39;</span>
<span class="go">|.      .      .      .      [------]      .| [4:5] &#39;a&#39;</span>
<span class="go">|.      .      .      .      .      [------]| [5:6] &#39;dog&#39;</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] S  -&gt; * NP VP</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * NP PP</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * Det Noun</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * &#39;I&#39;</span>
<span class="go">|[------]      .      .      .      .      .| [0:1] NP -&gt; &#39;I&#39; *</span>
<span class="go">|[------&gt;      .      .      .      .      .| [0:1] S  -&gt; NP * VP</span>
<span class="go">|[------&gt;      .      .      .      .      .| [0:1] NP -&gt; NP * PP</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * VP PP</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb NP</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] Verb -&gt; * &#39;saw&#39;</span>
<span class="go">|.      [------]      .      .      .      .| [1:2] Verb -&gt; &#39;saw&#39; *</span>
<span class="go">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; Verb * NP</span>
<span class="go">|.      [------]      .      .      .      .| [1:2] VP -&gt; Verb *</span>
<span class="go">|[-------------]      .      .      .      .| [0:2] S  -&gt; NP VP *</span>
<span class="go">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; VP * PP</span>
<span class="go">*** SWITCH TO BOTTOM UP</span>
<span class="go">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * &#39;John&#39;</span>
<span class="go">|.      .      .      &gt;      .      .      .| [3:3] PP -&gt; * &#39;with&#39; NP</span>
<span class="go">|.      .      .      &gt;      .      .      .| [3:3] Prep -&gt; * &#39;with&#39;</span>
<span class="go">|.      .      .      .      &gt;      .      .| [4:4] Det -&gt; * &#39;a&#39;</span>
<span class="go">|.      .      .      .      .      &gt;      .| [5:5] Noun -&gt; * &#39;dog&#39;</span>
<span class="go">|.      .      [------]      .      .      .| [2:3] NP -&gt; &#39;John&#39; *</span>
<span class="go">|.      .      .      [------&gt;      .      .| [3:4] PP -&gt; &#39;with&#39; * NP</span>
<span class="go">|.      .      .      [------]      .      .| [3:4] Prep -&gt; &#39;with&#39; *</span>
<span class="go">|.      .      .      .      [------]      .| [4:5] Det -&gt; &#39;a&#39; *</span>
<span class="go">|.      .      .      .      .      [------]| [5:6] Noun -&gt; &#39;dog&#39; *</span>
<span class="go">|.      [-------------]      .      .      .| [1:3] VP -&gt; Verb NP *</span>
<span class="go">|[--------------------]      .      .      .| [0:3] S  -&gt; NP VP *</span>
<span class="go">|.      [-------------&gt;      .      .      .| [1:3] VP -&gt; VP * PP</span>
<span class="go">|.      .      &gt;      .      .      .      .| [2:2] S  -&gt; * NP VP</span>
<span class="go">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * NP PP</span>
<span class="go">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * Det Noun</span>
<span class="go">|.      .      [------&gt;      .      .      .| [2:3] S  -&gt; NP * VP</span>
<span class="go">|.      .      [------&gt;      .      .      .| [2:3] NP -&gt; NP * PP</span>
<span class="go">|.      .      .      .      [------&gt;      .| [4:5] NP -&gt; Det * Noun</span>
<span class="go">|.      .      .      .      [-------------]| [4:6] NP -&gt; Det Noun *</span>
<span class="go">|.      .      .      [--------------------]| [3:6] PP -&gt; &#39;with&#39; NP *</span>
<span class="go">|.      [----------------------------------]| [1:6] VP -&gt; VP PP *</span>
<span class="go">*** SWITCH TO TOP DOWN</span>
<span class="go">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * Det Noun</span>
<span class="go">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * NP PP</span>
<span class="go">|.      .      .      &gt;      .      .      .| [3:3] VP -&gt; * VP PP</span>
<span class="go">|.      .      .      &gt;      .      .      .| [3:3] VP -&gt; * Verb NP</span>
<span class="go">|.      .      .      &gt;      .      .      .| [3:3] VP -&gt; * Verb</span>
<span class="go">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="go">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="go">|.      .      [---------------------------]| [2:6] NP -&gt; NP PP *</span>
<span class="go">|.      .      .      .      [-------------&gt;| [4:6] NP -&gt; NP * PP</span>
<span class="go">|.      [----------------------------------]| [1:6] VP -&gt; Verb NP *</span>
<span class="go">|.      .      [---------------------------&gt;| [2:6] S  -&gt; NP * VP</span>
<span class="go">|.      .      [---------------------------&gt;| [2:6] NP -&gt; NP * PP</span>
<span class="go">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="go">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="go">|.      .      .      .      .      .      &gt;| [6:6] VP -&gt; * VP PP</span>
<span class="go">|.      .      .      .      .      .      &gt;| [6:6] VP -&gt; * Verb NP</span>
<span class="go">|.      .      .      .      .      .      &gt;| [6:6] VP -&gt; * Verb</span>
<span class="go">*** SWITCH TO BOTTOM UP</span>
<span class="go">|.      .      .      .      &gt;      .      .| [4:4] S  -&gt; * NP VP</span>
<span class="go">|.      .      .      .      [-------------&gt;| [4:6] S  -&gt; NP * VP</span>
<span class="go">*** SWITCH TO TOP DOWN</span>
<span class="go">*** SWITCH TO BOTTOM UP</span>
<span class="go">*** SWITCH TO TOP DOWN</span>
<span class="go">*** SWITCH TO BOTTOM UP</span>
<span class="go">*** SWITCH TO TOP DOWN</span>
<span class="go">*** SWITCH TO BOTTOM UP</span>
<span class="go">Nr edges in chart: 61</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-incremental-chart-parser-class">
<h3>Unit tests for the Incremental Chart Parser class<a class="headerlink" href="#unit-tests-for-the-incremental-chart-parser-class" title="Permalink to this heading">¶</a></h3>
<p>The incremental chart parsers are defined in earleychart.py.
We use the demo() function for testing. We must turn off showing of times.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
<p>Earley Chart Parser</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">earleychart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw John with a dog&#39;</span><span class="p">,</span> <span class="n">numparses</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">* Sentence:</span>
<span class="go">I saw John with a dog</span>
<span class="go">[&#39;I&#39;, &#39;saw&#39;, &#39;John&#39;, &#39;with&#39;, &#39;a&#39;, &#39;dog&#39;]</span>

<span class="go">|.  I   . saw  . John . with .  a   . dog  .|</span>
<span class="go">|[------]      .      .      .      .      .| [0:1] &#39;I&#39;</span>
<span class="go">|.      [------]      .      .      .      .| [1:2] &#39;saw&#39;</span>
<span class="go">|.      .      [------]      .      .      .| [2:3] &#39;John&#39;</span>
<span class="go">|.      .      .      [------]      .      .| [3:4] &#39;with&#39;</span>
<span class="go">|.      .      .      .      [------]      .| [4:5] &#39;a&#39;</span>
<span class="go">|.      .      .      .      .      [------]| [5:6] &#39;dog&#39;</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] S  -&gt; * NP VP</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * NP PP</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * Det Noun</span>
<span class="go">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * &#39;I&#39;</span>
<span class="go">|[------]      .      .      .      .      .| [0:1] NP -&gt; &#39;I&#39; *</span>
<span class="go">|[------&gt;      .      .      .      .      .| [0:1] S  -&gt; NP * VP</span>
<span class="go">|[------&gt;      .      .      .      .      .| [0:1] NP -&gt; NP * PP</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * VP PP</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb NP</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb</span>
<span class="go">|.      &gt;      .      .      .      .      .| [1:1] Verb -&gt; * &#39;saw&#39;</span>
<span class="go">|.      [------]      .      .      .      .| [1:2] Verb -&gt; &#39;saw&#39; *</span>
<span class="go">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; Verb * NP</span>
<span class="go">|.      [------]      .      .      .      .| [1:2] VP -&gt; Verb *</span>
<span class="go">|[-------------]      .      .      .      .| [0:2] S  -&gt; NP VP *</span>
<span class="go">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; VP * PP</span>
<span class="go">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * NP PP</span>
<span class="go">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * Det Noun</span>
<span class="go">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * &#39;John&#39;</span>
<span class="go">|.      .      [------]      .      .      .| [2:3] NP -&gt; &#39;John&#39; *</span>
<span class="go">|.      [-------------]      .      .      .| [1:3] VP -&gt; Verb NP *</span>
<span class="go">|.      .      [------&gt;      .      .      .| [2:3] NP -&gt; NP * PP</span>
<span class="go">|.      .      .      &gt;      .      .      .| [3:3] PP -&gt; * &#39;with&#39; NP</span>
<span class="go">|[--------------------]      .      .      .| [0:3] S  -&gt; NP VP *</span>
<span class="go">|.      [-------------&gt;      .      .      .| [1:3] VP -&gt; VP * PP</span>
<span class="go">|.      .      .      [------&gt;      .      .| [3:4] PP -&gt; &#39;with&#39; * NP</span>
<span class="go">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * NP PP</span>
<span class="go">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * Det Noun</span>
<span class="go">|.      .      .      .      &gt;      .      .| [4:4] Det -&gt; * &#39;a&#39;</span>
<span class="go">|.      .      .      .      [------]      .| [4:5] Det -&gt; &#39;a&#39; *</span>
<span class="go">|.      .      .      .      [------&gt;      .| [4:5] NP -&gt; Det * Noun</span>
<span class="go">|.      .      .      .      .      &gt;      .| [5:5] Noun -&gt; * &#39;dog&#39;</span>
<span class="go">|.      .      .      .      .      [------]| [5:6] Noun -&gt; &#39;dog&#39; *</span>
<span class="go">|.      .      .      .      [-------------]| [4:6] NP -&gt; Det Noun *</span>
<span class="go">|.      .      .      [--------------------]| [3:6] PP -&gt; &#39;with&#39; NP *</span>
<span class="go">|.      .      .      .      [-------------&gt;| [4:6] NP -&gt; NP * PP</span>
<span class="go">|.      .      [---------------------------]| [2:6] NP -&gt; NP PP *</span>
<span class="go">|.      [----------------------------------]| [1:6] VP -&gt; VP PP *</span>
<span class="go">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="go">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="go">|.      [----------------------------------]| [1:6] VP -&gt; Verb NP *</span>
<span class="go">|.      .      [---------------------------&gt;| [2:6] NP -&gt; NP * PP</span>
<span class="go">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="go">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="go">(S</span>
<span class="go">  (NP I)</span>
<span class="go">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-large-context-free-grammars">
<h3>Unit tests for LARGE context-free grammars<a class="headerlink" href="#unit-tests-for-large-context-free-grammars" title="Permalink to this heading">¶</a></h3>
<p>Reading the ATIS grammar.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;grammars/large_grammars/atis.cfg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span>
<span class="go">&lt;Grammar with 5517 productions&gt;</span>
</pre></div>
</div>
<p>Reading the test sentences.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sentences</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;grammars/large_grammars/atis_sentences.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sentences</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">extract_test_sentences</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
<span class="go">98</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testsentence</span> <span class="o">=</span> <span class="n">sentences</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testsentence</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[&#39;show&#39;, &#39;me&#39;, &#39;northwest&#39;, &#39;flights&#39;, &#39;to&#39;, &#39;detroit&#39;, &#39;.&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testsentence</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sentence</span> <span class="o">=</span> <span class="n">testsentence</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Now we test all different parsing strategies.
Note that the number of edges differ between the strategies.</p>
<p>Bottom-up parsing.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">BottomUpChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">7661</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Bottom-up Left-corner parsing.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">BottomUpLeftCornerChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">4986</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Left-corner parsing with bottom-up filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">LeftCornerChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">1342</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Top-down parsing.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">TopDownChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">28352</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Incremental Bottom-up parsing.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">IncrementalBottomUpChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">7661</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Incremental Bottom-up Left-corner parsing.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">IncrementalBottomUpLeftCornerChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">4986</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Incremental Left-corner parsing with bottom-up filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">IncrementalLeftCornerChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">1342</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Incremental Top-down parsing.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">IncrementalTopDownChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">28352</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Earley parsing. This is similar to the incremental top-down algorithm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">EarleyChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">chart</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()))</span>
<span class="go">28352</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chart</span><span class="o">.</span><span class="n">parses</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">())))))</span>
<span class="go">17</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-probabilistic-cfg-class">
<h3>Unit tests for the Probabilistic CFG class<a class="headerlink" href="#unit-tests-for-the-probabilistic-cfg-class" title="Permalink to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">treebank</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk.grammar</span> <span class="kn">import</span> <span class="n">PCFG</span><span class="p">,</span> <span class="n">induce_pcfg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toy_pcfg1</span> <span class="o">=</span> <span class="n">PCFG</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">    S -&gt; NP VP [1.0]</span>
<span class="gp">... </span><span class="s2">    NP -&gt; Det N [0.5] | NP PP [0.25] | &#39;John&#39; [0.1] | &#39;I&#39; [0.15]</span>
<span class="gp">... </span><span class="s2">    Det -&gt; &#39;the&#39; [0.8] | &#39;my&#39; [0.2]</span>
<span class="gp">... </span><span class="s2">    N -&gt; &#39;man&#39; [0.5] | &#39;telescope&#39; [0.5]</span>
<span class="gp">... </span><span class="s2">    VP -&gt; VP PP [0.1] | V NP [0.7] | V [0.2]</span>
<span class="gp">... </span><span class="s2">    V -&gt; &#39;ate&#39; [0.35] | &#39;saw&#39; [0.65]</span>
<span class="gp">... </span><span class="s2">    PP -&gt; P NP [1.0]</span>
<span class="gp">... </span><span class="s2">    P -&gt; &#39;with&#39; [0.61] | &#39;under&#39; [0.39]</span>
<span class="gp">... </span><span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">toy_pcfg2</span> <span class="o">=</span> <span class="n">PCFG</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">    S    -&gt; NP VP         [1.0]</span>
<span class="gp">... </span><span class="s2">    VP   -&gt; V NP          [.59]</span>
<span class="gp">... </span><span class="s2">    VP   -&gt; V             [.40]</span>
<span class="gp">... </span><span class="s2">    VP   -&gt; VP PP         [.01]</span>
<span class="gp">... </span><span class="s2">    NP   -&gt; Det N         [.41]</span>
<span class="gp">... </span><span class="s2">    NP   -&gt; Name          [.28]</span>
<span class="gp">... </span><span class="s2">    NP   -&gt; NP PP         [.31]</span>
<span class="gp">... </span><span class="s2">    PP   -&gt; P NP          [1.0]</span>
<span class="gp">... </span><span class="s2">    V    -&gt; &#39;saw&#39;         [.21]</span>
<span class="gp">... </span><span class="s2">    V    -&gt; &#39;ate&#39;         [.51]</span>
<span class="gp">... </span><span class="s2">    V    -&gt; &#39;ran&#39;         [.28]</span>
<span class="gp">... </span><span class="s2">    N    -&gt; &#39;boy&#39;         [.11]</span>
<span class="gp">... </span><span class="s2">    N    -&gt; &#39;cookie&#39;      [.12]</span>
<span class="gp">... </span><span class="s2">    N    -&gt; &#39;table&#39;       [.13]</span>
<span class="gp">... </span><span class="s2">    N    -&gt; &#39;telescope&#39;   [.14]</span>
<span class="gp">... </span><span class="s2">    N    -&gt; &#39;hill&#39;        [.5]</span>
<span class="gp">... </span><span class="s2">    Name -&gt; &#39;Jack&#39;        [.52]</span>
<span class="gp">... </span><span class="s2">    Name -&gt; &#39;Bob&#39;         [.48]</span>
<span class="gp">... </span><span class="s2">    P    -&gt; &#39;with&#39;        [.61]</span>
<span class="gp">... </span><span class="s2">    P    -&gt; &#39;under&#39;       [.39]</span>
<span class="gp">... </span><span class="s2">    Det  -&gt; &#39;the&#39;         [.41]</span>
<span class="gp">... </span><span class="s2">    Det  -&gt; &#39;a&#39;           [.31]</span>
<span class="gp">... </span><span class="s2">    Det  -&gt; &#39;my&#39;          [.28]</span>
<span class="gp">... </span><span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a set of PCFG productions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">PCFG</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">A -&gt; B B [.3] | C B C [.7]</span>
<span class="gp">... </span><span class="s2">B -&gt; B D [.5] | C [.5]</span>
<span class="gp">... </span><span class="s2">C -&gt; &#39;a&#39; [.1] | &#39;b&#39; [0.9]</span>
<span class="gp">... </span><span class="s2">D -&gt; &#39;b&#39; [1.0]</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prod</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prod</span>
<span class="go">A -&gt; B B [0.3]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prod</span><span class="o">.</span><span class="n">lhs</span><span class="p">()</span>
<span class="go">A</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prod</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="go">(B, B)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">prod</span><span class="o">.</span><span class="n">prob</span><span class="p">()))</span>
<span class="go">0.3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">A</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="p">()</span>
<span class="go">[A -&gt; B B [0.3], A -&gt; C B C [0.7], B -&gt; B D [0.5], B -&gt; C [0.5], C -&gt; &#39;a&#39; [0.1], C -&gt; &#39;b&#39; [0.9], D -&gt; &#39;b&#39; [1.0]]</span>
</pre></div>
</div>
<p>Induce some productions using parsed Treebank data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">productions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">treebank</span><span class="o">.</span><span class="n">fileids</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">treebank</span><span class="o">.</span><span class="n">parsed_sents</span><span class="p">(</span><span class="n">fileid</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">productions</span> <span class="o">+=</span> <span class="n">t</span><span class="o">.</span><span class="n">productions</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">induce_pcfg</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">productions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span>
<span class="go">&lt;Grammar with 71 productions&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="p">(</span><span class="n">lhs</span><span class="o">=</span><span class="n">Nonterminal</span><span class="p">(</span><span class="s1">&#39;PP&#39;</span><span class="p">)))[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[PP -&gt; IN NP [1.0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="p">(</span><span class="n">lhs</span><span class="o">=</span><span class="n">Nonterminal</span><span class="p">(</span><span class="s1">&#39;NNP&#39;</span><span class="p">)))[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[NNP -&gt; &#39;Agnew&#39; [0.0714286], NNP -&gt; &#39;Consolidated&#39; [0.0714286]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="p">(</span><span class="n">lhs</span><span class="o">=</span><span class="n">Nonterminal</span><span class="p">(</span><span class="s1">&#39;JJ&#39;</span><span class="p">)))[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[JJ -&gt; &#39;British&#39; [0.142857], JJ -&gt; &#39;former&#39; [0.142857]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="p">(</span><span class="n">lhs</span><span class="o">=</span><span class="n">Nonterminal</span><span class="p">(</span><span class="s1">&#39;NP&#39;</span><span class="p">)))[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[NP -&gt; CD NNS [0.133333], NP -&gt; DT JJ JJ NN [0.0666667]]</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-probabilistic-chart-parse-classes">
<h3>Unit tests for the Probabilistic Chart Parse classes<a class="headerlink" href="#unit-tests-for-the-probabilistic-chart-parse-classes" title="Permalink to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="s2">&quot;Jack saw Bob with my cookie&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">toy_pcfg2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="go">Grammar with 23 productions (start state = S)</span>
<span class="go">    S -&gt; NP VP [1.0]</span>
<span class="go">    VP -&gt; V NP [0.59]</span>
<span class="go">    VP -&gt; V [0.4]</span>
<span class="go">    VP -&gt; VP PP [0.01]</span>
<span class="go">    NP -&gt; Det N [0.41]</span>
<span class="go">    NP -&gt; Name [0.28]</span>
<span class="go">    NP -&gt; NP PP [0.31]</span>
<span class="go">    PP -&gt; P NP [1.0]</span>
<span class="go">    V -&gt; &#39;saw&#39; [0.21]</span>
<span class="go">    V -&gt; &#39;ate&#39; [0.51]</span>
<span class="go">    V -&gt; &#39;ran&#39; [0.28]</span>
<span class="go">    N -&gt; &#39;boy&#39; [0.11]</span>
<span class="go">    N -&gt; &#39;cookie&#39; [0.12]</span>
<span class="go">    N -&gt; &#39;table&#39; [0.13]</span>
<span class="go">    N -&gt; &#39;telescope&#39; [0.14]</span>
<span class="go">    N -&gt; &#39;hill&#39; [0.5]</span>
<span class="go">    Name -&gt; &#39;Jack&#39; [0.52]</span>
<span class="go">    Name -&gt; &#39;Bob&#39; [0.48]</span>
<span class="go">    P -&gt; &#39;with&#39; [0.61]</span>
<span class="go">    P -&gt; &#39;under&#39; [0.39]</span>
<span class="go">    Det -&gt; &#39;the&#39; [0.41]</span>
<span class="go">    Det -&gt; &#39;a&#39; [0.31]</span>
<span class="go">    Det -&gt; &#39;my&#39; [0.28]</span>
</pre></div>
</div>
<p>Create several parsers using different queuing strategies and show the
resulting parses.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk.parse</span> <span class="kn">import</span> <span class="n">pchart</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">pchart</span><span class="o">.</span><span class="n">InsideChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (V saw)</span>
<span class="go">    (NP</span>
<span class="go">      (NP (Name Bob))</span>
<span class="go">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (VP (V saw) (NP (Name Bob)))</span>
<span class="go">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">pchart</span><span class="o">.</span><span class="n">RandomChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (V saw)</span>
<span class="go">    (NP</span>
<span class="go">      (NP (Name Bob))</span>
<span class="go">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (VP (V saw) (NP (Name Bob)))</span>
<span class="go">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">pchart</span><span class="o">.</span><span class="n">UnsortedChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (V saw)</span>
<span class="go">    (NP</span>
<span class="go">      (NP (Name Bob))</span>
<span class="go">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (VP (V saw) (NP (Name Bob)))</span>
<span class="go">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">pchart</span><span class="o">.</span><span class="n">LongestChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (V saw)</span>
<span class="go">    (NP</span>
<span class="go">      (NP (Name Bob))</span>
<span class="go">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (VP (V saw) (NP (Name Bob)))</span>
<span class="go">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">pchart</span><span class="o">.</span><span class="n">InsideChartParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">beam_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-viterbi-parse-classes">
<h3>Unit tests for the Viterbi Parse classes<a class="headerlink" href="#unit-tests-for-the-viterbi-parse-classes" title="Permalink to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk.parse</span> <span class="kn">import</span> <span class="n">ViterbiParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="s2">&quot;Jack saw Bob with my cookie&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">toy_pcfg2</span>
</pre></div>
</div>
<p>Parse the tokenized sentence.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">ViterbiParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(S</span>
<span class="go">  (NP (Name Jack))</span>
<span class="go">  (VP</span>
<span class="go">    (V saw)</span>
<span class="go">    (NP</span>
<span class="go">      (NP (Name Bob))</span>
<span class="go">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-featstructnonterminal-class">
<h3>Unit tests for the FeatStructNonterminal class<a class="headerlink" href="#unit-tests-for-the-featstructnonterminal-class" title="Permalink to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nltk.grammar</span> <span class="kn">import</span> <span class="n">FeatStructNonterminal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FeatStructNonterminal</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pos</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">agr</span><span class="o">=</span><span class="n">FeatStructNonterminal</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="s1">&#39;pl&#39;</span><span class="p">,</span> <span class="n">gender</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">))</span>
<span class="go">[agr=[gender=&#39;f&#39;, number=&#39;pl&#39;], pos=&#39;n&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FeatStructNonterminal</span><span class="p">(</span><span class="s1">&#39;VP[+fin]/NP[+pl]&#39;</span><span class="p">)</span>
<span class="go">VP[+fin]/NP[+pl]</span>
</pre></div>
</div>
</section>
<section id="tracing-the-feature-chart-parser">
<h3>Tracing the Feature Chart Parser<a class="headerlink" href="#tracing-the-feature-chart-parser" title="Permalink to this heading">¶</a></h3>
<p>We use the featurechart.demo() function for tracing the Feature Chart Parser.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">featurechart</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="n">print_times</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">print_grammar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">parser</span><span class="o">=</span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">featurechart</span><span class="o">.</span><span class="n">FeatureChartParser</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">sent</span><span class="o">=</span><span class="s1">&#39;I saw John with a dog&#39;</span><span class="p">)</span>

<span class="go">Grammar with 18 productions (start state = S[])</span>
<span class="go">    S[] -&gt; NP[] VP[]</span>
<span class="go">    PP[] -&gt; Prep[] NP[]</span>
<span class="go">    NP[] -&gt; NP[] PP[]</span>
<span class="go">    VP[] -&gt; VP[] PP[]</span>
<span class="go">    VP[] -&gt; Verb[] NP[]</span>
<span class="go">    VP[] -&gt; Verb[]</span>
<span class="go">    NP[] -&gt; Det[pl=?x] Noun[pl=?x]</span>
<span class="go">    NP[] -&gt; &#39;John&#39;</span>
<span class="go">    NP[] -&gt; &#39;I&#39;</span>
<span class="go">    Det[] -&gt; &#39;the&#39;</span>
<span class="go">    Det[] -&gt; &#39;my&#39;</span>
<span class="go">    Det[-pl] -&gt; &#39;a&#39;</span>
<span class="go">    Noun[-pl] -&gt; &#39;dog&#39;</span>
<span class="go">    Noun[-pl] -&gt; &#39;cookie&#39;</span>
<span class="go">    Verb[] -&gt; &#39;ate&#39;</span>
<span class="go">    Verb[] -&gt; &#39;saw&#39;</span>
<span class="go">    Prep[] -&gt; &#39;with&#39;</span>
<span class="go">    Prep[] -&gt; &#39;under&#39;</span>

<span class="go">* FeatureChartParser</span>
<span class="go">Sentence: I saw John with a dog</span>
<span class="go">|.I.s.J.w.a.d.|</span>
<span class="go">|[-] . . . . .| [0:1] &#39;I&#39;</span>
<span class="go">|. [-] . . . .| [1:2] &#39;saw&#39;</span>
<span class="go">|. . [-] . . .| [2:3] &#39;John&#39;</span>
<span class="go">|. . . [-] . .| [3:4] &#39;with&#39;</span>
<span class="go">|. . . . [-] .| [4:5] &#39;a&#39;</span>
<span class="go">|. . . . . [-]| [5:6] &#39;dog&#39;</span>
<span class="go">|[-] . . . . .| [0:1] NP[] -&gt; &#39;I&#39; *</span>
<span class="go">|[-&gt; . . . . .| [0:1] S[] -&gt; NP[] * VP[] {}</span>
<span class="go">|[-&gt; . . . . .| [0:1] NP[] -&gt; NP[] * PP[] {}</span>
<span class="go">|. [-] . . . .| [1:2] Verb[] -&gt; &#39;saw&#39; *</span>
<span class="go">|. [-&gt; . . . .| [1:2] VP[] -&gt; Verb[] * NP[] {}</span>
<span class="go">|. [-] . . . .| [1:2] VP[] -&gt; Verb[] *</span>
<span class="go">|. [-&gt; . . . .| [1:2] VP[] -&gt; VP[] * PP[] {}</span>
<span class="go">|[---] . . . .| [0:2] S[] -&gt; NP[] VP[] *</span>
<span class="go">|. . [-] . . .| [2:3] NP[] -&gt; &#39;John&#39; *</span>
<span class="go">|. . [-&gt; . . .| [2:3] S[] -&gt; NP[] * VP[] {}</span>
<span class="go">|. . [-&gt; . . .| [2:3] NP[] -&gt; NP[] * PP[] {}</span>
<span class="go">|. [---] . . .| [1:3] VP[] -&gt; Verb[] NP[] *</span>
<span class="go">|. [---&gt; . . .| [1:3] VP[] -&gt; VP[] * PP[] {}</span>
<span class="go">|[-----] . . .| [0:3] S[] -&gt; NP[] VP[] *</span>
<span class="go">|. . . [-] . .| [3:4] Prep[] -&gt; &#39;with&#39; *</span>
<span class="go">|. . . [-&gt; . .| [3:4] PP[] -&gt; Prep[] * NP[] {}</span>
<span class="go">|. . . . [-] .| [4:5] Det[-pl] -&gt; &#39;a&#39; *</span>
<span class="go">|. . . . [-&gt; .| [4:5] NP[] -&gt; Det[pl=?x] * Noun[pl=?x] {?x: False}</span>
<span class="go">|. . . . . [-]| [5:6] Noun[-pl] -&gt; &#39;dog&#39; *</span>
<span class="go">|. . . . [---]| [4:6] NP[] -&gt; Det[-pl] Noun[-pl] *</span>
<span class="go">|. . . . [---&gt;| [4:6] S[] -&gt; NP[] * VP[] {}</span>
<span class="go">|. . . . [---&gt;| [4:6] NP[] -&gt; NP[] * PP[] {}</span>
<span class="go">|. . . [-----]| [3:6] PP[] -&gt; Prep[] NP[] *</span>
<span class="go">|. . [-------]| [2:6] NP[] -&gt; NP[] PP[] *</span>
<span class="go">|. [---------]| [1:6] VP[] -&gt; VP[] PP[] *</span>
<span class="go">|. [---------&gt;| [1:6] VP[] -&gt; VP[] * PP[] {}</span>
<span class="go">|[===========]| [0:6] S[] -&gt; NP[] VP[] *</span>
<span class="go">|. . [-------&gt;| [2:6] S[] -&gt; NP[] * VP[] {}</span>
<span class="go">|. . [-------&gt;| [2:6] NP[] -&gt; NP[] * PP[] {}</span>
<span class="go">|. [---------]| [1:6] VP[] -&gt; Verb[] NP[] *</span>
<span class="go">|. [---------&gt;| [1:6] VP[] -&gt; VP[] * PP[] {}</span>
<span class="go">|[===========]| [0:6] S[] -&gt; NP[] VP[] *</span>
<span class="go">(S[]</span>
<span class="go">  (NP[] I)</span>
<span class="go">  (VP[]</span>
<span class="go">    (VP[] (Verb[] saw) (NP[] John))</span>
<span class="go">    (PP[] (Prep[] with) (NP[] (Det[-pl] a) (Noun[-pl] dog)))))</span>
<span class="go">(S[]</span>
<span class="go">  (NP[] I)</span>
<span class="go">  (VP[]</span>
<span class="go">    (Verb[] saw)</span>
<span class="go">    (NP[]</span>
<span class="go">      (NP[] John)</span>
<span class="go">      (PP[] (Prep[] with) (NP[] (Det[-pl] a) (Noun[-pl] dog))))))</span>
</pre></div>
</div>
</section>
<section id="unit-tests-for-the-feature-chart-parser-classes">
<h3>Unit tests for the Feature Chart Parser classes<a class="headerlink" href="#unit-tests-for-the-feature-chart-parser-classes" title="Permalink to this heading">¶</a></h3>
<p>The list of parsers we want to test.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parsers</span> <span class="o">=</span> <span class="p">[</span><span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">featurechart</span><span class="o">.</span><span class="n">FeatureChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">featurechart</span><span class="o">.</span><span class="n">FeatureTopDownChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">featurechart</span><span class="o">.</span><span class="n">FeatureBottomUpChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">featurechart</span><span class="o">.</span><span class="n">FeatureBottomUpLeftCornerChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">earleychart</span><span class="o">.</span><span class="n">FeatureIncrementalChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">earleychart</span><span class="o">.</span><span class="n">FeatureEarleyChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">earleychart</span><span class="o">.</span><span class="n">FeatureIncrementalTopDownChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">earleychart</span><span class="o">.</span><span class="n">FeatureIncrementalBottomUpChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">earleychart</span><span class="o">.</span><span class="n">FeatureIncrementalBottomUpLeftCornerChartParser</span><span class="p">,</span>
<span class="gp">... </span>           <span class="p">]</span>
</pre></div>
</div>
<p>A helper function that tests each parser on the given grammar and sentence.
We check that the number of trees are correct, and that all parsers
return the same trees. Otherwise an error is printed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">unittest</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">nr_trees</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">sentence</span> <span class="o">=</span> <span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">trees</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">parsers</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">!=</span> <span class="n">nr_trees</span><span class="p">:</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wrong nr of trees:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">elif</span> <span class="n">trees</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">trees</span> <span class="o">=</span> <span class="n">result</span>
<span class="gp">... </span>        <span class="k">elif</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">trees</span><span class="p">:</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trees differ for parser:&quot;</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>The demo grammar from before, with an ambiguous sentence.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">isawjohn</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">featurechart</span><span class="o">.</span><span class="n">demo_grammar</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unittest</span><span class="p">(</span><span class="n">isawjohn</span><span class="p">,</span> <span class="s2">&quot;I saw John with a dog with my cookie&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>This grammar tests that variables in different grammar rules are renamed
before unification. (The problematic variable is in this case ?X).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">whatwasthat</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">FeatureGrammar</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">S[] -&gt; NP[num=?N] VP[num=?N, slash=?X]</span>
<span class="gp">... </span><span class="s1">NP[num=?X] -&gt; &quot;what&quot;</span>
<span class="gp">... </span><span class="s1">NP[num=?X] -&gt; &quot;that&quot;</span>
<span class="gp">... </span><span class="s1">VP[num=?P, slash=none] -&gt; V[num=?P] NP[]</span>
<span class="gp">... </span><span class="s1">V[num=sg] -&gt; &quot;was&quot;</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unittest</span><span class="p">(</span><span class="n">whatwasthat</span><span class="p">,</span> <span class="s2">&quot;what was that&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This grammar tests that the same rule can be used in different places
in another rule, and that the variables are properly renamed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">thislovesthat</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">FeatureGrammar</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">S[] -&gt; NP[case=nom] V[] NP[case=acc]</span>
<span class="gp">... </span><span class="s1">NP[case=?X] -&gt; Pron[case=?X]</span>
<span class="gp">... </span><span class="s1">Pron[] -&gt; &quot;this&quot;</span>
<span class="gp">... </span><span class="s1">Pron[] -&gt; &quot;that&quot;</span>
<span class="gp">... </span><span class="s1">V[] -&gt; &quot;loves&quot;</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unittest</span><span class="p">(</span><span class="n">thislovesthat</span><span class="p">,</span> <span class="s2">&quot;this loves that&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="tests-for-loading-feature-grammar-files">
<h3>Tests for loading feature grammar files<a class="headerlink" href="#tests-for-loading-feature-grammar-files" title="Permalink to this heading">¶</a></h3>
<p>Alternative 1: first load the grammar, then create the parser.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fcfg</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;grammars/book_grammars/feat0.fcfg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fcp1</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">FeatureChartParser</span><span class="p">(</span><span class="n">fcfg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">type</span><span class="p">(</span><span class="n">fcp1</span><span class="p">)))</span>
<span class="go">&lt;class &#39;nltk.parse.featurechart.FeatureChartParser&#39;&gt;</span>
</pre></div>
</div>
<p>Alternative 2: directly load the parser.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fcp2</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">load_parser</span><span class="p">(</span><span class="s1">&#39;grammars/book_grammars/feat0.fcfg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">type</span><span class="p">(</span><span class="n">fcp2</span><span class="p">)))</span>
<span class="go">&lt;class &#39;nltk.parse.featurechart.FeatureChartParser&#39;&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>


        </div>
      </div>

    </div>

<footer>
    <div id="footer-info">
        <ul id="build-details">
            
                <li class="footer-element">
                    
                        <a href="../_sources/howto/parse.rst.txt" rel="nofollow"> source</a>
                    
                </li>
            

            
                <li class="footer-element">
                    <a href="https://github.com/nltk/nltk/tree/3.8.1">3.8.1</a>
                </li>
            

            
                <li class="footer-element">
                    Jan 02, 2023
                </li>
            
        </ul>

        
            <div id="copyright">
                &copy; 2023, NLTK Project
            </div>
        

        <div id="credit">
            created with <a href="http://sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/tomaarsen/nltk_theme">NLTK Theme</a>
        </div>
    </div>
</footer> 

</div>

</body>
</html>